<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>8&nbsp; Fourier Transform – Basics of Data Science</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../signal/laplace.html" rel="next">
<link href="../signal/index.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark-2fef5ea3f8957b3e4ecc936fc74692ca.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-f3e4be047f94999836566be8d7fec70b.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark-1cff5245d27da707879debdfdc57e7b2.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="../site_libs/bootstrap/bootstrap-f3e4be047f94999836566be8d7fec70b.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script src="../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const queryPrefersDark = window.matchMedia('(prefers-color-scheme: dark)');
    const darkModeDefault = queryPrefersDark.matches;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    queryPrefersDark.addEventListener("change", e => {
      if(window.localStorage.getItem("quarto-color-scheme") !== null)
        return;
      const alternate = e.matches
      toggleColorMode(alternate);
      localAlternateSentinel = e.matches ? 'alternate' : 'default'; // this is used alongside local storage!
      toggleGiscusIfUsed(alternate, darkModeDefault);
    });
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../signal/index.html">Signal Processing</a></li><li class="breadcrumb-item"><a href="../signal/fourier.html"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Fourier Transform</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Basics of Data Science</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/kandolfp/MECH-M-DUAL-1-DBM/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../basics/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Basics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basics/linearalgebra.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Linear Algebra</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basics/sets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data sets</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../matrixdc/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Matrix decompositions</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../matrixdc/eigen.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Eigendecomposition</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../matrixdc/svd.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Singular Value Decomposition</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Regression analysis</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../regression/linear.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Linear Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../regression/nonlinear.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Non-linear Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../regression/optimizers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Optimizers</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../signal/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Signal Processing</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../signal/fourier.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Fourier Transform</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../signal/laplace.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Laplace Transform</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../signal/wavelet.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Wavelet Transform</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../signal/twodim.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Two-Dimensional Transform</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../sensing/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Sparsity and compression</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../sensing/sparsity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Sparsity and Compression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../sensing/compsensing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Compressed Sensing</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../statistics/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../statistics/bayesian.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Bayesian Statistics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../statistics/kalman.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Kalman Filter</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Summary</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#fourier-series" id="toc-fourier-series" class="nav-link active" data-scroll-target="#fourier-series"><span class="header-section-number">8.1</span> Fourier Series</a></li>
  <li><a href="#fourier-transform" id="toc-fourier-transform" class="nav-link" data-scroll-target="#fourier-transform"><span class="header-section-number">8.2</span> Fourier Transform</a></li>
  <li><a href="#discrete-fourier-transform" id="toc-discrete-fourier-transform" class="nav-link" data-scroll-target="#discrete-fourier-transform"><span class="header-section-number">8.3</span> Discrete Fourier Transform</a></li>
  <li><a href="#fast-fourier-transform" id="toc-fast-fourier-transform" class="nav-link" data-scroll-target="#fast-fourier-transform"><span class="header-section-number">8.4</span> Fast-Fourier Transform</a>
  <ul class="collapse">
  <li><a href="#examples-for-the-fft-in-action" id="toc-examples-for-the-fft-in-action" class="nav-link" data-scroll-target="#examples-for-the-fft-in-action"><span class="header-section-number">8.4.1</span> Examples for the FFT in action</a></li>
  </ul></li>
  <li><a href="#gabor-transform" id="toc-gabor-transform" class="nav-link" data-scroll-target="#gabor-transform"><span class="header-section-number">8.5</span> Gabor Transform</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/kandolfp/MECH-M-DUAL-1-DBM/edit/main/signal/fourier.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/kandolfp/MECH-M-DUAL-1-DBM/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../signal/index.html">Signal Processing</a></li><li class="breadcrumb-item"><a href="../signal/fourier.html"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Fourier Transform</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-signal-fourier" class="quarto-section-identifier"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Fourier Transform</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>The fourier transform helps us convert a signal from the time domain to the frequency domain. In this section our main concern is going to be one dimensional signals, but the concepts can be applied to multiple dimensions.</p>
<p>Before we can start defining the <em>Fourier Series</em> we need to extend our notion of vector space to functions space. This is done with <em>Hilbert</em> spaces. The computational rules follow the same principal as in <a href="../basics/linearalgebra.html#def-vectorspace" class="quarto-xref">Definition&nbsp;<span>1.1</span></a>, what we want to investigate is the inner product.</p>
<div class="callout callout-style-simple callout-none no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="def-hilbert-innerproduct" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 8.1 (Hilbert inner product)</strong></span> The <em>Hilbert inner product</em> of two functions <span class="math inline">\(f(x)\)</span> and <span class="math inline">\(g(x)\)</span> is defined for <span class="math inline">\(x \in [a, b]\)</span> as: <span class="math display">\[
\langle f(x), g(x)\rangle = \int_a^b f(x) \overline{g}(x)\, \mathrm{d}x,
\]</span> where <span class="math inline">\(\overline{g}(x)\)</span> denotes the complex conjugate.</p>
</div>
</div>
</div>
</div>
<p>At first this looks strange but it is closely related to our already known <a href="../basics/linearalgebra.html#def-dotproduct" class="quarto-xref">Definition&nbsp;<span>1.3</span></a>.</p>
<p>As a first step, if we move from real to complex vector spaces the transpose is replaced by the conjugate transposed or hermit transpose, in notation the <span class="math inline">\(^\mathbf{T}\)</span> becomes <span class="math inline">\(^\mathbf{H}\)</span>.</p>
<p>Now consider a discrete version of <span class="math inline">\(f\)</span> and <span class="math inline">\(g\)</span> at regular intervals <span class="math inline">\(\Delta x = \frac{b-a}{n-1}\)</span> where <span class="math display">\[
f_i = f(x_i) = f(a + (i - 1) \Delta x),\quad i = 1, \ldots n,
\]</span> same for <span class="math inline">\(g_i\)</span> and accordingly <span class="math inline">\(x_1 = a + 0 \Delta x = a\)</span> and <span class="math inline">\(x_n = a + (n - 1)\Delta x = b\)</span>.</p>
<p>The inner product is then <span class="math display">\[
\langle f, g \rangle = \langle\left[\begin{array}{c}f_1 \\ f_2 \\ \vdots \\ f_n \end{array}\right], \left[\begin{array}{c}g_1 \\ g_2 \\ \vdots \\ g_n \end{array}\right] \rangle = \sum_{i=1}^n f_i \overline{g}_i = \sum_{i=1}^n f(x_i)\overline{g}(x_i).
\]</span></p>
<p>As this sum will increase by increasing <span class="math inline">\(n\)</span> we should normalize it by the factor <span class="math inline">\(\Delta x\)</span>.</p>
<p><span class="math display">\[
\frac{b-a}{n-1} \langle g, f \rangle = \sum_{i=1}^n f(x_i)\overline{g}(x_i) \Delta x.
\]</span> If we now increase <span class="math inline">\(n\to \infty\)</span> we get <span class="math inline">\(\Delta x \to 0\)</span> and the sum transforms into the integral.</p>
<div class="callout callout-style-simple callout-none no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="def-hilbert-two-norm" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 8.2 (Hilbert two norm)</strong></span> The <em>Hilbert two norm</em> of the function <span class="math inline">\(f(x)\)</span> is defined for <span class="math inline">\(x \in [a, b]\)</span> as: <span class="math display">\[
\|f\|_2 = \sqrt{\langle f(x), f(x)\rangle} = \left(\int_a^b f(x) \overline{f}(x)\,\mathrm{d}x\right)^{\frac12},
\]</span> where <span class="math inline">\(\overline{f}(x)\)</span> denotes the complex conjugate.</p>
<p>The set of all functions with bounded norm defines the Hilbert space <span class="math inline">\(L^2(a, b)\)</span>, i.e.&nbsp;the set of all square integrable functions. This space is also called the space of <em>Lebesgue</em> integrable functions.</p>
</div>
</div>
</div>
</div>
<p>Similar as we saw projection in vector spaces related to the inner product this is true here as well.</p>
<div class="callout callout-style-simple callout-none no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="def-fourier-periodic" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 8.3 (Periodic function)</strong></span> We call a function <span class="math inline">\(f\,:\, \mathbb{R} \to \mathbb{R}\)</span> periodic with a period of <span class="math inline">\(L&gt;0\)</span>, <span class="math inline">\(L\)</span>-periodic for short, if <span class="math display">\[
f(t + L) = f(t),\quad\forall t \in \mathbb{R}.
\]</span></p>
<p>The following holds true for <span class="math inline">\(L\)</span>-periodic functions:</p>
<ol type="1">
<li>If <span class="math inline">\(L\)</span> is a period than <span class="math inline">\(nL\)</span> for <span class="math inline">\(n = 1, 2, 3, \ldots\)</span> is a period as well.</li>
<li>If <span class="math inline">\(f\)</span> and <span class="math inline">\(g\)</span> are <span class="math inline">\(L\)</span>-periodic, than <span class="math inline">\(\alpha f + \beta g\)</span> are <span class="math inline">\(L\)</span>-periodic, for <span class="math inline">\(\alpha, \beta \in \mathbb{C}\)</span>.</li>
<li>If <span class="math inline">\(f\)</span> is <span class="math inline">\(L\)</span>-periodic it follows that <span class="math inline">\(\forall a\in\mathbb{R}\)</span> <span class="math display">\[
\int_a^{a+T}f(t)\,\mathrm{d}t = \int_0^{T}f(t)\,\mathrm{d}t.
\]</span></li>
<li>If <span class="math inline">\(f\)</span> is <span class="math inline">\(L\)</span>-periodic than <span class="math inline">\(F(t)=f(\frac{t}{\omega})\)</span> with <span class="math inline">\(\omega = \frac{2\pi}{L}\)</span> is <span class="math inline">\(2\pi\)</span>-periodic.</li>
</ol>
</div>
</div>
</div>
</div>
<p>The Fourier series is nothing else as the projection of a function with an integer period on the domain <span class="math inline">\([a, b]\)</span> onto the orthogonal basis defined by the sine and cosine functions.</p>
<section id="fourier-series" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="fourier-series"><span class="header-section-number">8.1</span> Fourier Series</h2>
<p>In Fourier analysis the first result is stated for a periodic and piecewise smooth function <span class="math inline">\(f(t)\)</span>.</p>
<div class="callout callout-style-simple callout-none no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="def-fourier-series" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 8.4 (Fourier Series)</strong></span> For a <span class="math inline">\(L\)</span>-periodic function <span class="math inline">\(f(t)\)</span> we can write <span id="eq-fs"><span class="math display">\[
f(t) = \frac{a_0}{2} + \sum_{k=1}^\infty \left(a_k \cos\left(\omega k t \right)+ b_k \sin\left(\omega k t\right)\right),
\tag{8.1}\]</span></span> for <span class="math display">\[
\begin{aligned}
a_k &amp;= \frac{2}{L}\int_0^L f(t) \cos\left(\omega k t \right)\, \mathrm{d}t,\\
b_k &amp;= \frac{2}{L}\int_0^L f(t) \sin\left(\omega k t \right)\, \mathrm{d}t.
\end{aligned}
\]</span> where we can view the last two equations as the projection onto the orthogonal basis <span class="math inline">\(\{\cos(k t), \sin(k t)\}_{k=0}^\infty\)</span>, i.e. <span class="math display">\[
\begin{aligned}
a_k &amp;= \frac{1}{\|\cos\left(\omega k t\right)\|_2^2} \langle f(t), \cos\left(\omega k t\right)\rangle, \\
b_k &amp;= \frac{1}{\|\sin\left(\omega k t\right)\|_2^2} \langle f(t), \sin\left(\omega k t\right)\rangle.
\end{aligned}
\]</span></p>
<p>If we perform a partial reconstruction by truncating the series at <span class="math inline">\(M\)</span> we get <span class="math display">\[
\hat{f}_M(t) = \frac{a_0}{2} + \sum_{k=1}^M \left(a_k \cos\left(\omega k t \right)+ b_k \sin\left(\omega k t \right)\right).
\]</span></p>
</div>
</div>
</div>
</div>
<p>With the help of Euler’s formula: <span id="eq-euler"><span class="math display">\[
\mathrm{e}^{\mathrm{i} k t} = \cos(k t) + \mathrm{i} \sin(k t)
\tag{8.2}\]</span></span> we can rewrite <a href="#eq-fs" class="quarto-xref">Equation&nbsp;<span>8.1</span></a> as <span class="math display">\[
f(t) = \sum_{k=-\infty}^\infty c_k \mathrm{e}^{\omega\mathrm{i} k t},
\]</span> with <span class="math display">\[
c_k = \frac{1}{L} \int_0^L f(t) \mathrm{e}^{-\omega\mathrm{i} k t}\, \mathrm{d}t.
\]</span> and for <span class="math inline">\(n=1, 2, 3, \ldots\)</span> <span class="math display">\[
c_0 = \tfrac12 a_0, \quad c_n = \tfrac12 (a_n - \mathrm{i} b_n), \quad c_{-n} = \tfrac12 (a_n + \mathrm{i} b_n).
\]</span></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>If <span class="math inline">\(f(t)\)</span> is real valued than <span class="math inline">\(c_k = \overline{c}_{-k}\)</span>.</p>
</div>
</div>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="exm-fourier-hat" class="theorem example">
<p><span class="theorem-title"><strong>Example 8.1 (Fourier Series of Hat functions)</strong></span> We test the Fourier Series with two different hat functions. The first represents a triangle with constant slope up and down, the second a rectangle with infinite slope in the corners.</p>
<details class="code-fold">
<summary>Show the code for the figure</summary>
<div class="sourceCode cell-code" id="annotated-cell-2"><pre class="sourceCode python code-annotation-code code-with-copy code-annotated"><code class="sourceCode python"><span id="annotated-cell-2-1"><a href="#annotated-cell-2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="annotated-cell-2-2"><a href="#annotated-cell-2-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="annotated-cell-2-3"><a href="#annotated-cell-2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-2-4"><a href="#annotated-cell-2-4" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>config InlineBackend.figure_formats <span class="op">=</span> [<span class="st">"svg"</span>]</span>
<span id="annotated-cell-2-5"><a href="#annotated-cell-2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-2-6"><a href="#annotated-cell-2-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameters</span></span>
<span id="annotated-cell-2-7"><a href="#annotated-cell-2-7" aria-hidden="true" tabindex="-1"></a>L <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> np.pi</span>
<span id="annotated-cell-2-8"><a href="#annotated-cell-2-8" aria-hidden="true" tabindex="-1"></a>M <span class="op">=</span> <span class="dv">5</span></span>
<span id="annotated-cell-2-9"><a href="#annotated-cell-2-9" aria-hidden="true" tabindex="-1"></a>M2 <span class="op">=</span> <span class="dv">50</span></span>
<span id="annotated-cell-2-10"><a href="#annotated-cell-2-10" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> <span class="dv">512</span></span>
<span id="annotated-cell-2-11"><a href="#annotated-cell-2-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Hat functions</span></span>
<span id="annotated-cell-2-12"><a href="#annotated-cell-2-12" aria-hidden="true" tabindex="-1"></a>fun <span class="op">=</span> <span class="kw">lambda</span> t, L: <span class="dv">0</span> <span class="cf">if</span> <span class="bu">abs</span>(t) <span class="op">&gt;</span> L <span class="op">/</span> <span class="dv">4</span> <span class="cf">else</span> (<span class="dv">1</span> <span class="op">-</span> np.sign(t) <span class="op">*</span> t <span class="op">*</span> <span class="dv">4</span> <span class="op">/</span> L)</span>
<span id="annotated-cell-2-13"><a href="#annotated-cell-2-13" aria-hidden="true" tabindex="-1"></a>fun2 <span class="op">=</span> <span class="kw">lambda</span> t, L: <span class="dv">0</span> <span class="cf">if</span> <span class="bu">abs</span>(t) <span class="op">&gt;</span> L <span class="op">/</span> <span class="dv">4</span> <span class="cf">else</span> <span class="dv">1</span></span>
<span id="annotated-cell-2-14"><a href="#annotated-cell-2-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-2-15"><a href="#annotated-cell-2-15" aria-hidden="true" tabindex="-1"></a><span class="co"># t</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-2" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-2-16" class="code-annotation-target"><a href="#annotated-cell-2-16" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> np.linspace(<span class="op">-</span>L <span class="op">/</span> <span class="dv">2</span>, L <span class="op">/</span> <span class="dv">2</span>, N, endpoint<span class="op">=</span><span class="va">False</span>)</span>
<span id="annotated-cell-2-17"><a href="#annotated-cell-2-17" aria-hidden="true" tabindex="-1"></a>dt <span class="op">=</span> t[<span class="dv">1</span>] <span class="op">-</span> t[<span class="dv">0</span>]</span>
<span id="annotated-cell-2-18"><a href="#annotated-cell-2-18" aria-hidden="true" tabindex="-1"></a>w <span class="op">=</span> np.pi <span class="op">*</span> <span class="dv">2</span> <span class="op">/</span> L</span>
<span id="annotated-cell-2-19"><a href="#annotated-cell-2-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-2-20"><a href="#annotated-cell-2-20" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> np.fromiter(<span class="bu">map</span>(<span class="kw">lambda</span> t: fun(t, L), t), t.dtype)</span>
<span id="annotated-cell-2-21"><a href="#annotated-cell-2-21" aria-hidden="true" tabindex="-1"></a>f2 <span class="op">=</span> np.fromiter(<span class="bu">map</span>(<span class="kw">lambda</span> t: fun2(t, L), t), t.dtype)</span>
<span id="annotated-cell-2-22"><a href="#annotated-cell-2-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-2-23"><a href="#annotated-cell-2-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Necessary functions</span></span>
<span id="annotated-cell-2-24"><a href="#annotated-cell-2-24" aria-hidden="true" tabindex="-1"></a>scalarproduct <span class="op">=</span> <span class="kw">lambda</span> f, g, dt: dt <span class="op">*</span> np.vecdot(f, g)</span>
<span id="annotated-cell-2-25"><a href="#annotated-cell-2-25" aria-hidden="true" tabindex="-1"></a>a_coeff <span class="op">=</span> <span class="kw">lambda</span> n, f: <span class="dv">2</span> <span class="op">/</span> L <span class="op">*</span> scalarproduct(f, np.cos(w <span class="op">*</span> n <span class="op">*</span> t), dt)</span>
<span id="annotated-cell-2-26"><a href="#annotated-cell-2-26" aria-hidden="true" tabindex="-1"></a>b_coeff <span class="op">=</span> <span class="kw">lambda</span> n, f: <span class="dv">2</span> <span class="op">/</span> L <span class="op">*</span> scalarproduct(f, np.sin(w <span class="op">*</span> n <span class="op">*</span> t), dt)</span>
<span id="annotated-cell-2-27"><a href="#annotated-cell-2-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-2-28"><a href="#annotated-cell-2-28" aria-hidden="true" tabindex="-1"></a><span class="co"># f_hat_0</span></span>
<span id="annotated-cell-2-29"><a href="#annotated-cell-2-29" aria-hidden="true" tabindex="-1"></a>f_hat <span class="op">=</span> np.zeros((M <span class="op">+</span> <span class="dv">1</span>, N))</span>
<span id="annotated-cell-2-30"><a href="#annotated-cell-2-30" aria-hidden="true" tabindex="-1"></a>f_hat[<span class="dv">0</span>, :] <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> <span class="dv">2</span> <span class="op">*</span> a_coeff(<span class="dv">0</span>, f)</span>
<span id="annotated-cell-2-31"><a href="#annotated-cell-2-31" aria-hidden="true" tabindex="-1"></a>f2_hat <span class="op">=</span> np.zeros((M2 <span class="op">+</span> <span class="dv">1</span>, N))</span>
<span id="annotated-cell-2-32"><a href="#annotated-cell-2-32" aria-hidden="true" tabindex="-1"></a>f2_hat[<span class="dv">0</span>, :] <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> <span class="dv">2</span> <span class="op">*</span> a_coeff(<span class="dv">0</span>, f2)</span>
<span id="annotated-cell-2-33"><a href="#annotated-cell-2-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-2-34"><a href="#annotated-cell-2-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Computation of the approximation</span></span>
<span id="annotated-cell-2-35"><a href="#annotated-cell-2-35" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.zeros(M)</span>
<span id="annotated-cell-2-36"><a href="#annotated-cell-2-36" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> np.zeros(M)</span>
<span id="annotated-cell-2-37"><a href="#annotated-cell-2-37" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(M):</span>
<span id="annotated-cell-2-38"><a href="#annotated-cell-2-38" aria-hidden="true" tabindex="-1"></a>    a[i] <span class="op">=</span> a_coeff(i <span class="op">+</span> <span class="dv">1</span>, f)</span>
<span id="annotated-cell-2-39"><a href="#annotated-cell-2-39" aria-hidden="true" tabindex="-1"></a>    b[i] <span class="op">=</span> b_coeff(i <span class="op">+</span> <span class="dv">1</span>, f)</span>
<span id="annotated-cell-2-40"><a href="#annotated-cell-2-40" aria-hidden="true" tabindex="-1"></a>    f_hat[i <span class="op">+</span> <span class="dv">1</span>, :] <span class="op">=</span> (</span>
<span id="annotated-cell-2-41"><a href="#annotated-cell-2-41" aria-hidden="true" tabindex="-1"></a>        f_hat[i, :] <span class="op">+</span> a[i] <span class="op">*</span> np.cos(w <span class="op">*</span> (i <span class="op">+</span> <span class="dv">1</span>) <span class="op">*</span> t) <span class="op">+</span> b[i] <span class="op">*</span> np.sin(w <span class="op">*</span> (i <span class="op">+</span> <span class="dv">1</span>) <span class="op">*</span> t)</span>
<span id="annotated-cell-2-42"><a href="#annotated-cell-2-42" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="annotated-cell-2-43"><a href="#annotated-cell-2-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-2-44"><a href="#annotated-cell-2-44" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(M2):</span>
<span id="annotated-cell-2-45"><a href="#annotated-cell-2-45" aria-hidden="true" tabindex="-1"></a>    f2_hat[i <span class="op">+</span> <span class="dv">1</span>, :] <span class="op">=</span> (</span>
<span id="annotated-cell-2-46"><a href="#annotated-cell-2-46" aria-hidden="true" tabindex="-1"></a>        f2_hat[i, :]</span>
<span id="annotated-cell-2-47"><a href="#annotated-cell-2-47" aria-hidden="true" tabindex="-1"></a>        <span class="op">+</span> a_coeff(i <span class="op">+</span> <span class="dv">1</span>, f2) <span class="op">*</span> np.cos(w <span class="op">*</span> (i <span class="op">+</span> <span class="dv">1</span>) <span class="op">*</span> t)</span>
<span id="annotated-cell-2-48"><a href="#annotated-cell-2-48" aria-hidden="true" tabindex="-1"></a>        <span class="op">+</span> b_coeff(i <span class="op">+</span> <span class="dv">1</span>, f2) <span class="op">*</span> np.sin(w <span class="op">*</span> (i <span class="op">+</span> <span class="dv">1</span>) <span class="op">*</span> t)</span>
<span id="annotated-cell-2-49"><a href="#annotated-cell-2-49" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="annotated-cell-2-50"><a href="#annotated-cell-2-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-2-51"><a href="#annotated-cell-2-51" aria-hidden="true" tabindex="-1"></a><span class="co"># Figures</span></span>
<span id="annotated-cell-2-52"><a href="#annotated-cell-2-52" aria-hidden="true" tabindex="-1"></a>plt.figure(<span class="dv">0</span>)</span>
<span id="annotated-cell-2-53"><a href="#annotated-cell-2-53" aria-hidden="true" tabindex="-1"></a>plt.plot(t, f, label<span class="op">=</span><span class="vs">r"</span><span class="dv">$</span><span class="vs">f</span><span class="dv">$</span><span class="vs">"</span>)</span>
<span id="annotated-cell-2-54"><a href="#annotated-cell-2-54" aria-hidden="true" tabindex="-1"></a>plt.plot(t, f_hat[<span class="op">-</span><span class="dv">1</span>, :], label<span class="op">=</span><span class="vs">r"</span><span class="dv">$</span><span class="er">\</span><span class="vs">hat{f_7}</span><span class="dv">$</span><span class="vs">"</span>)</span>
<span id="annotated-cell-2-55"><a href="#annotated-cell-2-55" aria-hidden="true" tabindex="-1"></a>plt.xticks([])</span>
<span id="annotated-cell-2-56"><a href="#annotated-cell-2-56" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="annotated-cell-2-57"><a href="#annotated-cell-2-57" aria-hidden="true" tabindex="-1"></a>plt.gca().set_aspect(<span class="fl">1.5</span>)</span>
<span id="annotated-cell-2-58"><a href="#annotated-cell-2-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-2-59"><a href="#annotated-cell-2-59" aria-hidden="true" tabindex="-1"></a>plt.figure(<span class="dv">1</span>)</span>
<span id="annotated-cell-2-60"><a href="#annotated-cell-2-60" aria-hidden="true" tabindex="-1"></a>plt.plot(t, f_hat[<span class="dv">0</span>, :], label<span class="op">=</span><span class="vs">rf"</span><span class="dv">$</span><span class="vs">a_</span><span class="sc">{</span><span class="dv">0</span><span class="sc">}</span><span class="dv">$</span><span class="vs">"</span>)</span>
<span id="annotated-cell-2-61"><a href="#annotated-cell-2-61" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(M):</span>
<span id="annotated-cell-2-62"><a href="#annotated-cell-2-62" aria-hidden="true" tabindex="-1"></a>    plt.plot(t, a[i] <span class="op">*</span> np.cos(w <span class="op">*</span> (i <span class="op">+</span> <span class="dv">1</span>) <span class="op">*</span> t), label<span class="op">=</span><span class="vs">rf"</span><span class="dv">$</span><span class="vs">a_</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="er">\</span><span class="vs">cos</span><span class="kw">(</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="er">\</span><span class="vs">omega t</span><span class="kw">)</span><span class="dv">$</span><span class="vs">"</span>)</span>
<span id="annotated-cell-2-63"><a href="#annotated-cell-2-63" aria-hidden="true" tabindex="-1"></a>plt.legend(ncol<span class="op">=</span>np.ceil((M <span class="op">+</span> <span class="dv">1</span>) <span class="op">/</span> <span class="dv">2</span>), bbox_to_anchor<span class="op">=</span>(<span class="dv">1</span>, <span class="op">-</span><span class="fl">0.1</span>))</span>
<span id="annotated-cell-2-64"><a href="#annotated-cell-2-64" aria-hidden="true" tabindex="-1"></a>plt.xticks([])</span>
<span id="annotated-cell-2-65"><a href="#annotated-cell-2-65" aria-hidden="true" tabindex="-1"></a>plt.gca().set_aspect(<span class="fl">1.5</span>)</span>
<span id="annotated-cell-2-66"><a href="#annotated-cell-2-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-2-67"><a href="#annotated-cell-2-67" aria-hidden="true" tabindex="-1"></a>plt.figure(<span class="dv">2</span>)</span>
<span id="annotated-cell-2-68"><a href="#annotated-cell-2-68" aria-hidden="true" tabindex="-1"></a>plt.plot(t, f2, label<span class="op">=</span><span class="vs">r"</span><span class="dv">$</span><span class="vs">f</span><span class="dv">$</span><span class="vs">"</span>)</span>
<span id="annotated-cell-2-69"><a href="#annotated-cell-2-69" aria-hidden="true" tabindex="-1"></a>plt.plot(t, f2_hat[<span class="dv">7</span>, :], label<span class="op">=</span><span class="vs">r"</span><span class="dv">$</span><span class="er">\</span><span class="vs">hat{f}_7</span><span class="dv">$</span><span class="vs">"</span>)</span>
<span id="annotated-cell-2-70"><a href="#annotated-cell-2-70" aria-hidden="true" tabindex="-1"></a>plt.plot(t, f2_hat[<span class="dv">20</span>, :], label<span class="op">=</span><span class="vs">r"</span><span class="dv">$</span><span class="er">\</span><span class="vs">hat{f}_</span><span class="op">{20}</span><span class="dv">$</span><span class="vs">"</span>)</span>
<span id="annotated-cell-2-71"><a href="#annotated-cell-2-71" aria-hidden="true" tabindex="-1"></a>plt.plot(t, f2_hat[<span class="dv">50</span>, :], label<span class="op">=</span><span class="vs">r"</span><span class="dv">$</span><span class="er">\</span><span class="vs">hat{f}_</span><span class="op">{50}</span><span class="dv">$</span><span class="vs">"</span>)</span>
<span id="annotated-cell-2-72"><a href="#annotated-cell-2-72" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="vs">r"</span><span class="dv">$</span><span class="vs">x</span><span class="dv">$</span><span class="vs">"</span>)</span>
<span id="annotated-cell-2-73"><a href="#annotated-cell-2-73" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="annotated-cell-2-74"><a href="#annotated-cell-2-74" aria-hidden="true" tabindex="-1"></a>plt.gca().set_aspect(<span class="fl">1.5</span>)</span>
<span id="annotated-cell-2-75"><a href="#annotated-cell-2-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-2-76"><a href="#annotated-cell-2-76" aria-hidden="true" tabindex="-1"></a>plt.show()</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-2" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-2" data-code-lines="16" data-code-annotation="1">Not including the endpoint is important, as this is part of the periodicity of the function.</span>
</dd>
</dl>
</div>
<div id="fig-fourier_hat" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fourier_hat-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-fourier_hat" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="fig-fourier_hat-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-fourier_hat-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="fourier_files/figure-html/fig-fourier_hat-output-1.svg" class="lightbox" data-gallery="fig-fourier_hat" title="Figure&nbsp;8.1&nbsp;(a): Sawtooth function and the reconstruction with 7 nodes"><img src="fourier_files/figure-html/fig-fourier_hat-output-1.svg" class="img-fluid figure-img" data-ref-parent="fig-fourier_hat"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-fourier_hat-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Sawtooth function and the reconstruction with 7 nodes
</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="cell-output cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-fourier_hat" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="fig-fourier_hat-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-fourier_hat-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="fourier_files/figure-html/fig-fourier_hat-output-2.svg" class="lightbox" data-gallery="fig-fourier_hat" title="Figure&nbsp;8.1&nbsp;(b): Nodes of the reconstruction"><img src="fourier_files/figure-html/fig-fourier_hat-output-2.svg" class="img-fluid figure-img" data-ref-parent="fig-fourier_hat"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-fourier_hat-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Nodes of the reconstruction
</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="cell-output cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-fourier_hat" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="fig-fourier_hat-3" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-fourier_hat-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="fourier_files/figure-html/fig-fourier_hat-output-3.svg" class="lightbox" data-gallery="fig-fourier_hat" title="Figure&nbsp;8.1&nbsp;(c): Step function and the reconstruction with various nodes"><img src="fourier_files/figure-html/fig-fourier_hat-output-3.svg" class="img-fluid figure-img" data-ref-parent="fig-fourier_hat"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-fourier_hat-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(c) Step function and the reconstruction with various nodes
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fourier_hat-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8.1: Fourier transform of a two hat functions.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-caution no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="exr-fourier-hat-self" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 8.1 (Self implementation <a href="#exm-fourier-hat" class="quarto-xref">Example&nbsp;<span>8.1</span></a>)</strong></span> Implement the code yourself by filling out the missing sections:</p>
<div id="d285e4f5" class="cell" data-execution_count="2">
<details class="code-fold">
<summary>Code fragment for implementation.</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameters</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>L <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> np.pi  <span class="co"># Interval</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>M <span class="op">=</span> <span class="dv">5</span>  <span class="co"># Nodes for the first function</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>M2 <span class="op">=</span> <span class="dv">50</span>  <span class="co"># Nodes for the second function</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> <span class="dv">512</span>  <span class="co"># Interpolation points</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Hat functions</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>fun <span class="op">=</span> <span class="kw">lambda</span> x, L: <span class="co"># tooth</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>fun2 <span class="op">=</span> <span class="kw">lambda</span> x, L: <span class="co"># step</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co"># x and y for the functions</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> <span class="co"># points for the evaluation ()</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>dt <span class="op">=</span> t[<span class="dv">1</span>] <span class="op">-</span> t[<span class="dv">0</span>]</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>w <span class="op">=</span> np.pi <span class="op">*</span> <span class="dv">2</span> <span class="op">/</span> L</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> np.fromiter(<span class="bu">map</span>(<span class="kw">lambda</span> t: fun(t, L), t), t.dtype)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>f2 <span class="op">=</span> np.fromiter(<span class="bu">map</span>(<span class="kw">lambda</span> t: fun2(t, L), t), t.dtype)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Necessary functions</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>scalarproduct <span class="op">=</span> <span class="kw">lambda</span> f, g, dt: <span class="co"># see definition in the notes</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>a_coeff <span class="op">=</span> <span class="kw">lambda</span> n, f: <span class="co"># see definition in the notes</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>b_coeff <span class="op">=</span> <span class="kw">lambda</span> n, f: <span class="co"># see definition in the notes</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="co"># f_hat_0</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>f_hat <span class="op">=</span> np.zeros((M <span class="op">+</span> <span class="dv">1</span>, N))</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>f_hat[<span class="dv">0</span>, :] <span class="op">=</span> <span class="co"># a_0 for f</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>f2_hat <span class="op">=</span> np.zeros((M2 <span class="op">+</span> <span class="dv">1</span>, N))</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>f2_hat[<span class="dv">0</span>, :] <span class="op">=</span> <span class="co"># a_0 for f2</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Computation of the approximation</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.zeros(M)</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> np.zeros(M)</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(M):</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>    a[i] <span class="op">=</span> a_coeff(i <span class="op">+</span> <span class="dv">1</span>, f)</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>    b[i] <span class="op">=</span> b_coeff(i <span class="op">+</span> <span class="dv">1</span>, f)</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>    f_hat[i <span class="op">+</span> <span class="dv">1</span>, :] <span class="op">=</span> (</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>        f_hat[i, :] <span class="op">+</span> a[i] <span class="op">*</span> np.cos(w <span class="op">*</span> (i <span class="op">+</span> <span class="dv">1</span>) <span class="op">*</span> t) <span class="op">+</span> b[i] <span class="op">*</span> np.sin(w <span class="op">*</span> (i <span class="op">+</span> <span class="dv">1</span>) <span class="op">*</span> t)</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(M2):</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>    f2_hat[i <span class="op">+</span> <span class="dv">1</span>, :] <span class="op">=</span> (</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>        f2_hat[i, :]</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>        <span class="op">+</span> a_coeff(i <span class="op">+</span> <span class="dv">1</span>, f2) <span class="op">*</span> np.cos(w <span class="op">*</span> (i <span class="op">+</span> <span class="dv">1</span>) <span class="op">*</span> t)</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>        <span class="op">+</span> b_coeff(i <span class="op">+</span> <span class="dv">1</span>, f2) <span class="op">*</span> np.sin(w <span class="op">*</span> (i <span class="op">+</span> <span class="dv">1</span>) <span class="op">*</span> t)</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Figures</span></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>plt.figure(<span class="dv">0</span>)</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>plt.plot(t, f, label<span class="op">=</span><span class="vs">r"</span><span class="dv">$</span><span class="vs">f</span><span class="dv">$</span><span class="vs">"</span>)</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>plt.plot(t, f_hat[<span class="op">-</span><span class="dv">1</span>, :], label<span class="op">=</span><span class="vs">r"</span><span class="dv">$</span><span class="er">\</span><span class="vs">hat{f_7}</span><span class="dv">$</span><span class="vs">"</span>)</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>plt.xticks([])</span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>plt.gca().set_aspect(<span class="fl">1.5</span>)</span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>plt.figure(<span class="dv">1</span>)</span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>plt.plot(t, f_hat[<span class="dv">0</span>, :], label<span class="op">=</span><span class="vs">rf"</span><span class="dv">$</span><span class="vs">a_</span><span class="sc">{</span><span class="dv">0</span><span class="sc">}</span><span class="dv">$</span><span class="vs">"</span>)</span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(M):</span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>    plt.plot(t, a[i] <span class="op">*</span> np.cos(w <span class="op">*</span> (i <span class="op">+</span> <span class="dv">1</span>) <span class="op">*</span> t), label<span class="op">=</span><span class="vs">rf"</span><span class="dv">$</span><span class="vs">a_</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="er">\</span><span class="vs">cos</span><span class="kw">(</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="er">\</span><span class="vs">omega t</span><span class="kw">)</span><span class="dv">$</span><span class="vs">"</span>)</span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>plt.legend(ncol<span class="op">=</span>np.ceil((M <span class="op">+</span> <span class="dv">1</span>) <span class="op">/</span> <span class="dv">2</span>), bbox_to_anchor<span class="op">=</span>(<span class="dv">1</span>, <span class="op">-</span><span class="fl">0.1</span>))</span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>plt.xticks([])</span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>plt.gca().set_aspect(<span class="fl">1.5</span>)</span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>plt.figure(<span class="dv">2</span>)</span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>plt.plot(t, f2, label<span class="op">=</span><span class="vs">r"</span><span class="dv">$</span><span class="vs">f</span><span class="dv">$</span><span class="vs">"</span>)</span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>plt.plot(t, f2_hat[<span class="dv">7</span>, :], label<span class="op">=</span><span class="vs">r"</span><span class="dv">$</span><span class="er">\</span><span class="vs">hat{f}_7</span><span class="dv">$</span><span class="vs">"</span>)</span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>plt.plot(t, f2_hat[<span class="dv">20</span>, :], label<span class="op">=</span><span class="vs">r"</span><span class="dv">$</span><span class="er">\</span><span class="vs">hat{f}_</span><span class="op">{20}</span><span class="dv">$</span><span class="vs">"</span>)</span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>plt.plot(t, f2_hat[<span class="dv">50</span>, :], label<span class="op">=</span><span class="vs">r"</span><span class="dv">$</span><span class="er">\</span><span class="vs">hat{f}_</span><span class="op">{50}</span><span class="dv">$</span><span class="vs">"</span>)</span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="vs">r"</span><span class="dv">$</span><span class="vs">x</span><span class="dv">$</span><span class="vs">"</span>)</span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>plt.gca().set_aspect(<span class="fl">1.5</span>)</span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The phenomenon that the truncated Fourier series oscillates in <a href="#fig-fourier_hat-3" class="quarto-xref">Figure&nbsp;<span>8.1 (c)</span></a> due to the discontinuity of the function is called the Gibbs phenomenon.</p>
</div>
</div>
</section>
<section id="fourier-transform" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="fourier-transform"><span class="header-section-number">8.2</span> Fourier Transform</h2>
<p>The Fourier Series is defined for <span class="math inline">\(L\)</span>-periodic functions. The Fourier transform extends this to functions with the domain extended to <span class="math inline">\(\pm\infty\)</span>.</p>
<p>Let us start of with the series representation we already know: <span class="math display">\[
f(t) = \sum_{k=-\infty}^\infty c_k \mathrm{e}^{\mathrm{i} \omega k t},
\]</span> with the coefficients <span class="math display">\[
c_k = \frac{1}{2L} \int_{-L}^{L} f(t) \mathrm{e}^{-\mathrm{i} \omega_k t}\, \mathrm{d}t,
\]</span> with <span class="math inline">\(\omega_k=\frac{k\pi}{L} = k\Delta \omega\)</span>.</p>
<p>If we now perform the transition for <span class="math inline">\(L \to \infty\)</span> resulting in <span class="math inline">\(\Delta\omega \to 0\)</span> and basically moving from discrete frequencies to a continuous set of frequencies. This results in <span class="math display">\[
f(t) = \lim_{\Delta \omega \to 0} \sum_{k=-\infty}^\infty \frac{\Delta \omega}{2\pi}
\int_{-\tfrac{\pi}{\Delta \omega}}^{\tfrac{\pi}{\Delta \omega}} f(\xi) \mathrm{e}^{-\mathrm{i} k \Delta \omega \xi}\, \mathrm{d}\xi\,\, \mathrm{e}^{\Delta\omega\mathrm{i} k t},
\]</span> which is a Riemann integral and the kernel becomes the Fourier Transform of our function.</p>
<div class="callout callout-style-simple callout-none no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="def-fourier-transform" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 8.5 (Fourier Transform)</strong></span> A function <span class="math inline">\(f\,:\, \mathbb{R} \to \mathbb{R}\)</span> is called <em>Fourier-transformable</em> if <span class="math display">\[
\hat{f}(\omega) = \mathcal{F}\{f(t)\} = \int_{-\infty}^{\infty} f(t)\mathrm{e}^{-\mathrm{i} \omega t}\, \mathrm{d}t
\]</span> exists for all <span class="math inline">\(\omega\in\mathbb{R}\)</span>. In this case we call <span class="math inline">\(\hat{f}(\omega) \equiv \mathcal{F}\{f(t)\}\)</span> the <strong>Fourier transform</strong> of <span class="math inline">\(f(t)\)</span>.</p>
<p>The <strong>inverse Fourier transform</strong> is defined as <span class="math display">\[
\mathcal{F}^{-1}\{\hat{f}(\omega)\} = \frac{1}{2 \pi}\int_{-\infty}^{\infty} \hat{f}(\omega)\mathrm{e}^{\mathrm{i} \omega x}\, \mathrm{d}\omega.
\]</span></p>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The pair <span class="math inline">\((f, \hat{f})\)</span> is often called the <em>Fourier transform pair</em>.</p>
<p>The two integrals converge, as long as both functions are Lebesgue integrable, i.e.&nbsp; <span class="math display">\[
\int_{-\infty}^\infty|f(t)|\, \mathrm{d}t \le \infty \quad\text{and}\quad
\int_{-\infty}^\infty|\hat{f}(\omega)|\, \mathrm{d}\omega \le \infty,\]</span> or <span class="math inline">\(f, \hat{f} \in L^1[(-\infty, \infty)]\)</span>.</p>
</div>
</div>
<p>As could be expected, the Fourier transform has properties that lead to computational advantages.</p>
<p>For two functions <span class="math inline">\(f, g \in L^1[(-\infty, \infty)]\)</span> and <span class="math inline">\(\alpha, \beta\in\mathbb{C}\)</span> the following properties hold:</p>
<ol type="1">
<li><p><strong>Linearity</strong> <span class="math display">\[
\mathcal{F}\{\alpha f(t) + \beta g(t)\} =
\alpha \mathcal{F}\{f(t)\} + \beta \mathcal{F}\{g(t)\} =
\alpha \hat{f}(\omega)+ \beta \hat{g}(\omega),
\]</span> and <span class="math display">\[
\mathcal{F}^{-1}\{\alpha \hat{f}(\omega) + \beta \hat{g}(\omega)\} =
\alpha \mathcal{F}^{-1}\{\hat{f}(\omega)\} + \beta \mathcal{F}^{-1}\{\hat{g}(\omega)\} =
\alpha f(t) + \beta g(t).
\]</span></p></li>
<li><p><strong>Conjugation</strong> <span class="math display">\[
\mathcal{F}\{\overline{f(t)}\} = \overline{\hat{f}(-\omega)}.
\]</span></p></li>
<li><p><strong>Scaling</strong>, for <span class="math inline">\(\alpha \neq 0\)</span> <span class="math display">\[
\mathcal{F}\{f(\alpha t)\} = \frac{1}{|\alpha|}\hat{f}\left(\frac{\omega}{\alpha}\right).
\]</span></p></li>
<li><p><strong>Drift in time</strong>, for <span class="math inline">\(a\in\mathbb{R}\)</span> <span class="math display">\[
\mathcal{F}\{f(t - a)\} = \mathrm{e}^{-\mathrm{i}\omega a}\hat{f}(\omega).
\]</span></p></li>
<li><p><strong>Drift in frequency</strong>, for <span class="math inline">\(a\in\mathbb{R}\)</span> <span class="math display">\[
\mathrm{e}^{\mathrm{i} a t} \mathcal{F}\{f(t)\} = \hat{f}(\omega - a).
\]</span></p></li>
<li><p>If <span class="math inline">\(f\)</span> is <strong>even</strong> or <strong>odd</strong>, than <span class="math inline">\(\hat{f}\)</span> is even or odd, respectively.</p></li>
<li><p><strong>Derivative in time</strong> <span class="math display">\[
\mathcal{F}\{\partial_t f(t)\} = \mathrm{i} \omega \hat{f}(\omega)
\]</span> We are going to prove this by going through the lines <span class="math display">\[
\begin{aligned}
\mathcal{F}\left\{\frac{d}{d\,t}f(t)\right\} &amp;= \int_{-\infty}^\infty f'(t)\mathrm{e}^{-\mathrm{i}\omega t}\, \mathrm{d}t \\
&amp;= \left[f(t)\mathrm{e}^{-\mathrm{i}\omega t}\right]_{-\infty}^\infty - \int_{-\infty}^\infty -\mathrm{i} \omega f(t)\mathrm{e}^{-\mathrm{i}\omega t}\, \mathrm{d}t \\
&amp;= \mathrm{i} \omega \int_{-\infty}^\infty f(t)\mathrm{e}^{-\mathrm{i}\omega t}\, \mathrm{d}t \\
&amp;= \mathrm{i} \omega \mathcal{F}\{f(t)\}
\end{aligned}
\]</span> For higher derivatives we get <span class="math display">\[
\mathcal{F}\{\partial_t^n f(t)\} = \mathrm{i}^n \omega^n \hat{f}(\omega)
\]</span></p></li>
<li><p><strong>Derivative in frequency</strong> <span class="math display">\[
\mathcal{F}\{t^n f(t)\} = \mathrm{i}^n \partial_\omega^n\hat{f}(\omega)
\]</span></p></li>
<li><p>The <strong>convolution</strong> of two functions is defined as <span class="math display">\[
(f \ast g)(t) = \int_{-\infty}^{\infty}f(t - \xi) g(\xi)\, \mathrm{d}\xi,
\]</span> and for the Fourier transform <span class="math display">\[
\mathcal{F}\{(f \ast g)(t)\} = \hat{f} \cdot \hat{g}.
\]</span></p></li>
<li><p><strong>Parseval’s Theorem</strong> <span class="math display">\[
\|f\|_2^2 = \int_{-\infty}^{\infty}|f(t)|^2\, \mathrm{d}t = \frac{1}{2 \pi}\int_{-\infty}^{\infty}|\hat{f}(\omega)|^2\, \mathrm{d}\omega
\]</span> stating that the Fourier Transform preserves the 2-norm up to a scaling factor.</p></li>
</ol>
</section>
<section id="discrete-fourier-transform" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="discrete-fourier-transform"><span class="header-section-number">8.3</span> Discrete Fourier Transform</h2>
<p>The Discrete Fourier Transform (DFT) is a way of approximating the Fourier transform on discrete vectors of data and essentially it is nothing else than sampling the function and using numerical integration.</p>
<div class="callout callout-style-simple callout-none no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="def-fourier-dft" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 8.6 (Discrete-Fourier Transform)</strong></span> For equally spaced values <span class="math inline">\(t_k = k\Delta t\)</span>, for <span class="math inline">\(k\in\mathbb{Z}\)</span> and <span class="math inline">\(\Delta t&gt;0\)</span> and the discrete values of the function evaluations <span class="math inline">\(f_k=f(t_k)\)</span>. If the function is periodic with <span class="math inline">\(L=N\Delta t\)</span> then the discrete Fourier transform is given as <span id="eq-dft"><span class="math display">\[
\hat{f}_k = \sum_{j=0}^{N-1}f_j\, \mathrm{e}^{-\mathrm{i} j k\tfrac{2 \pi}{N}},
\tag{8.3}\]</span></span> and its inverse (iDFT) as <span class="math display">\[
f_k = \frac{1}{N}\sum_{j=0}^{N-1}\hat{f}_j\, \mathrm{e}^{\mathrm{i} j k\tfrac{2 \pi}{N}}.
\]</span></p>
</div>
</div>
</div>
</div>
<p>As we can see, the DFT is a linear operator and therefore it can be written as a matrix vector product <span id="eq-dft_matrix"><span class="math display">\[
\left[
    \begin{array}{c} \hat{f}_1 \\ \hat{f}_2 \\ \hat{f}_3 \\ \vdots \\ \hat{f}_N \end{array}
\right]
=
\left[
    \begin{array}{ccccc} 1 &amp; 1 &amp; 1 &amp; \dots &amp; 1 \\
                         1 &amp; \omega_N &amp; \omega_N^2 &amp; \dots &amp; \omega_N^{N-1} \\  
                         1 &amp; \omega_N^2 &amp; \omega_N^4 &amp; \dots &amp; \omega_N^{2(N-1)} \\
                         \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots\\
                         1 &amp; \omega_N^{N-1} &amp; \omega_N^{2(N-1)} &amp; \dots &amp; \omega_N^{(N-1)^2 } \\
    \end{array}
\right]
\left[
    \begin{array}{c} f_1 \\ f_2 \\ f_3 \\ \vdots \\ f_N \end{array}
\right]
\tag{8.4}\]</span></span> with <span class="math inline">\(\omega_N = \exp({-\mathrm{i} \tfrac{2 \pi}{N}})\)</span>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The matrix of the DFT is a unitary Vandermonde matrix.</p>
</div>
</div>
<p>As we can transfer the properties of the Fourier transform to the DFT we get the nice properties for sampled signals.</p>
<p>The downside of the DFT is that it does not scale well for large <span class="math inline">\(N\)</span> as the matrix-vector multiplication is <span class="math inline">\(\mathcal{O}(N^2)\)</span> and becomes slow.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Code for the computation of the DFT matrix.</p>
<div id="af680bf1" class="cell" data-execution_count="3">
<details class="code-fold">
<summary>Show the code.</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameters</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> <span class="dv">256</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>w <span class="op">=</span> np.exp(<span class="op">-</span><span class="ot">1j</span> <span class="op">*</span> <span class="dv">2</span> <span class="op">*</span> np.pi <span class="op">/</span> N)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>J, K <span class="op">=</span> np.meshgrid(np.arange(N), np.arange(N))</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>DFT <span class="op">=</span> np.power(w, J <span class="op">*</span> K)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</section>
<section id="fast-fourier-transform" class="level2" data-number="8.4">
<h2 data-number="8.4" class="anchored" data-anchor-id="fast-fourier-transform"><span class="header-section-number">8.4</span> Fast-Fourier Transform</h2>
<blockquote class="blockquote">
<p>In 1965, James W. Cooley (IBM) and John W. Tukey (Princeton) developed the so called <em>fast Fourier transform</em> (FFT) that scales with <span class="math inline">\(\mathcal{O}(N \log(N))\)</span>, which becomes almost linear for large enough <span class="math inline">\(N\)</span>, see <span class="citation" data-cites="Cooley1965">Cooley and Tukey (<a href="../references.html#ref-Cooley1965" role="doc-biblioref">1965</a>)</span>.</p>
</blockquote>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>To give an idea of what this change means and why this algorithm was a game changer. Audio is most of the time sampled with 44.1kHz, i.e.&nbsp;44 100 samples per second. For a 10s audio clip the vector <span class="math inline">\(f\)</span> will have the length <span class="math inline">\(N = 4.41 \times 10^5\)</span>. The DFT computation (without generating the matrix) results in approximately <span class="math inline">\(2\times 10^{11}\)</span> multiplications. The FFT on the other hand requires <span class="math inline">\(6\times 10^6\)</span> leading to a speed-up of about <span class="math inline">\(30 000\)</span>.</p>
<p>How this influenced our world we know from the use in our daily communication networks.</p>
<p><span class="citation" data-cites="Brunton2022">(Compare <a href="../references.html#ref-Brunton2022" role="doc-biblioref">Brunton and Kutz 2022, 65–66</a>)</span></p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>We should note that Cooley and Tukey where not the first to propose a FFT but they provided the formulation used today. Gauss already formulated the FFT 150 years earlier in 1805 for orbital approximations. Apparently, he did the necessary computations in his head and needed a fast algorithm so he developed the FFT. Gauss being Gauss did not see this as something important and it did not get published until 1866 in his compiled notes, <span class="citation" data-cites="Gauss">Gauß (<a href="../references.html#ref-Gauss" role="doc-biblioref">1866</a>)</span>.</p>
</div>
</div>
<p>The main idea of the FFT is to exploit symmetries in the Fourier transform and to relate the <span class="math inline">\(N\)</span>-dimensional DFT to a lower dimensional DFT by reordering the coefficients.</p>
<div class="callout callout-style-simple callout-none no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="def-fourier-fft" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 8.7 (Fast-Fourier Transform)</strong></span> If we assume that <span class="math inline">\(N = 2^n\)</span>, i.e.&nbsp;a power of <span class="math inline">\(2\)</span>, in particular <span class="math inline">\(N=2M\)</span>, and <span class="math inline">\(F_N\)</span> denotes the matrix of <a href="#eq-dft" class="quarto-xref">Equation&nbsp;<span>8.3</span></a> for dimension <span class="math inline">\(N\)</span> we get have <span class="math inline">\(\hat{f} = F_N f\)</span> and <span class="math inline">\(f = \tfrac1N \overline{F_N} \hat{f}\)</span>. If we further split <span class="math inline">\(f\)</span> in the even and odd indices as <span class="math display">\[e = [f_0, f_2, \ldots, f_{N-2}]^{\mathsf{T}}\in \mathbb{C}^{M}\]</span> and <span class="math display">\[o = [f_1, f_3, \ldots, f_{N-1}]^{\mathsf{T}}\in \mathbb{C}^{M}\]</span> and with <a href="#eq-dft" class="quarto-xref">Equation&nbsp;<span>8.3</span></a> we get <span class="math display">\[
\begin{aligned}
\hat{f}_k &amp;= \sum_{j=0}^{N-1}f_j\, \omega^{j k} = \sum_{j=0}^{M-1}f_{2j}\, \omega^{(2j) k} + \sum_{j=0}^{M-1}f_{2j+1}\, \omega^{(2j+1) k} \\
&amp;= \sum_{j=0}^{M-1}e_j\, (\omega^2)^{j k} + \omega^k\sum_{j=0}^{M-1}o_{j}\, (\omega^2)^{j k}.
\end{aligned}
\]</span> If we then split <span class="math inline">\(\hat{f}\)</span> in an upper and lower part <span class="math display">\[u = [\hat{f}_0, \hat{f}_2, \ldots, \hat{f}_{M-1}]^{\mathsf{T}}\in \mathbb{C}^{M}\]</span> and <span class="math display">\[l = [\hat{f}_{M}, \hat{f}_{M+1}, \ldots, \hat{f}_{N-1}]^{\mathsf{T}}\in \mathbb{C}^{M}\]</span> and with the property <span class="math inline">\(\omega^{k+M} = \omega^k \omega^M = - \omega^k\)</span> we get</p>
<p><span class="math display">\[
\begin{aligned}
u_k &amp;= \sum_{j=0}^{M-1}e_j\, (\omega^2)^{j k} + \omega^k\sum_{j=0}^{M-1}o_{j}\, (\omega^2)^{j k},\\
l_k &amp;= \sum_{j=0}^{M-1}e_j\, (\omega^2)^{j k} - \omega^k\sum_{j=0}^{M-1}o_{j}\, (\omega^2)^{j k}.
\end{aligned}
\]</span> This results in the more visual matrix representation <span class="math display">\[
\hat{f}= F_N f =
\left[
    \begin{array}{cc}
    I_M &amp; D_M \\
    I_M &amp; -D_M
    \end{array}
\right]
\left[
    \begin{array}{cc}
    F_M &amp; 0 \\
    0 &amp; F_M
    \end{array}
\right]
\left[
    \begin{array}{cc}
    f_{even}\\
    f_{odd}
    \end{array}
\right],
\]</span> for <span class="math inline">\(I_M\)</span> being the identity matrix in dimension <span class="math inline">\(M\)</span> and <span class="math display">\[
D_M =
\left[
    \begin{array}{ccccc} 1 &amp; 0 &amp; 0 &amp; \dots &amp; 0 \\
                         0 &amp; \omega &amp; 0 &amp; \dots &amp; 0 \\  
                         0 &amp; 0 &amp; \omega^2 &amp; \dots &amp; 0 \\
                         \vdots &amp; \vdots &amp; \ddots &amp; \ddots &amp;\vdots\\
                         0 &amp; 0 &amp; 0 &amp; \dots &amp; \omega^{(M-1)} \\
    \end{array}
\right].
\]</span> Now repeat this <span class="math inline">\(n\)</span> times.</p>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>If <span class="math inline">\(N\)</span> is not a power of <span class="math inline">\(2\)</span> padding is used to make the size fit by extending the vector with zeros.</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The original FFT paper <span class="citation" data-cites="Cooley1965">(<a href="../references.html#ref-Cooley1965" role="doc-biblioref">Cooley and Tukey 1965</a>)</span> uses bit flipping and similar techniques to boost performance even more. It can even be implemented to allow for in place computation to save storage.</p>
<p><span class="math display">\[
\begin{array}{|c|c|c|c|c|}
\hline
&amp; \text{bit flip} &amp; M = 1 &amp; M = 2 &amp; M = 4 \\
\hline
c_0 &amp; \xi_0 = c_0\ (c_{eee}) &amp; \eta_0 = \xi_0 + w^0 \xi_1 &amp; \zeta_0 = \eta_0 + w^0 \eta_2 &amp; y_0 = \zeta_0 + w^0 \zeta_4 \\
c_1 &amp; \xi_1 = c_4\ (c_{eeo}) &amp; \eta_1 = \xi_0 + w^4 \xi_1 &amp; \zeta_1 = \eta_0 + w^2 \eta_3 &amp; y_1 = \zeta_0 + w^1 \zeta_5 \\
c_2 &amp; \xi_2 = c_2\ (c_{eoe}) &amp; \eta_2 = \xi_2 + w^0 \xi_3 &amp; \zeta_2 = \eta_1 + w^4 \eta_2 &amp; y_2 = \zeta_1 + w^2 \zeta_6 \\
c_3 &amp; \xi_3 = c_6\ (c_{eoo}) &amp; \eta_3 = \xi_2 + w^4 \xi_3 &amp; \zeta_3 = \eta_1 + w^6 \eta_3 &amp; y_3 = \zeta_1 + w^3 \zeta_7 \\
c_4 &amp; \xi_4 = c_1\ (c_{oee}) &amp; \eta_4 = \xi_4 + w^0 \xi_5 &amp; \zeta_4 = \eta_4 + w^0 \eta_6 &amp; y_4 = \zeta_2 + w^0 \zeta_4 \\
c_5 &amp; \xi_5 = c_5\ (c_{oeo}) &amp; \eta_5 = \xi_4 + w^4 \xi_5 &amp; \zeta_5 = \eta_4 + w^2 \eta_7 &amp; y_5 = \zeta_2 + w^1 \zeta_5 \\
c_6 &amp; \xi_6 = c_3\ (c_{ooe}) &amp; \eta_6 = \xi_6 + w^0 \xi_7 &amp; \zeta_6 = \eta_5 + w^4 \eta_6 &amp; y_6 = \zeta_3 + w^2 \zeta_6 \\
c_7 &amp; \xi_7 = c_7\ (c_{ooo}) &amp; \eta_7 = \xi_6 + w^4 \xi_7 &amp; \zeta_7 = \eta_5 + w^6 \eta_7 &amp; y_7 = \zeta_3 + w^3 \zeta_7 \\
\hline
\end{array}
\]</span></p>
<p>In the above table <span class="math inline">\(o\)</span> stands for odd and <span class="math inline">\(e\)</span> for even.</p>
<p><span class="citation" data-cites="Meyberg1992-ws">(Compare <a href="../references.html#ref-Meyberg1992-ws" role="doc-biblioref">Meyberg and Vachenauer 1992, 331</a>)</span></p>
</div>
</div>
<section id="examples-for-the-fft-in-action" class="level3" data-number="8.4.1">
<h3 data-number="8.4.1" class="anchored" data-anchor-id="examples-for-the-fft-in-action"><span class="header-section-number">8.4.1</span> Examples for the FFT in action</h3>
<p>In order to give an idea how FFT works in an application we follow the examples given in <span class="citation" data-cites="Brunton2022">(<a href="../references.html#ref-Brunton2022" role="doc-biblioref">Brunton and Kutz 2022, 66–76</a>)</span>.</p>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="exm-fourier-fft-den" class="theorem example">
<p><span class="theorem-title"><strong>Example 8.2 (FFT for de-noising)</strong></span> For a signal consisting of two main frequencies <span class="math inline">\(f_1 = 50\)</span> and <span class="math inline">\(f_2=120\)</span> we construct a signal <span class="math display">\[
f(t) = \sin(2\pi f_1 t) + \sin(2\pi f_2 t)
\]</span> and add some Gaussian white noise <code>np.random.randn</code>.</p>
<p>We compute the FFT from the two signals and their power spectral density (PSD), i.e.&nbsp; <span class="math display">\[
PSD(\hat{f})=\frac1N \|\hat{f}\|^2.
\]</span> We use the PSD to take all frequencies with a <span class="math inline">\(PSD &lt; 100\)</span> out of our reconstruction as a filter. This removes noise from the signal.</p>
<details class="code-fold">
<summary>Show the code for the figure</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>config InlineBackend.figure_formats <span class="op">=</span> [<span class="st">"svg"</span>]</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">6020</span>)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameters</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> <span class="dv">1024</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>a, b <span class="op">=</span> <span class="dv">0</span>, <span class="dv">1</span> <span class="op">/</span> <span class="dv">4</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> np.linspace(a, b, N, endpoint<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>dt <span class="op">=</span> t[<span class="dv">1</span>] <span class="op">-</span> t[<span class="dv">0</span>]</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>f1 <span class="op">=</span> <span class="dv">50</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>f2 <span class="op">=</span> <span class="dv">120</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>fun <span class="op">=</span> <span class="kw">lambda</span> t: np.sin(<span class="dv">2</span> <span class="op">*</span> np.pi <span class="op">*</span> f1 <span class="op">*</span> t) <span class="op">+</span> np.sin(<span class="dv">2</span> <span class="op">*</span> np.pi <span class="op">*</span> f2 <span class="op">*</span> t)</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>f_clean <span class="op">=</span> fun(t)</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>f_noise <span class="op">=</span> fun(t) <span class="op">+</span> <span class="fl">2.5</span> <span class="op">*</span> np.random.randn(<span class="bu">len</span>(t))  <span class="co"># Add some noise</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>fhat_noise <span class="op">=</span> np.fft.fft(f_noise)</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>fhat_clean <span class="op">=</span> np.fft.fft(f_clean)</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>PSD_noise <span class="op">=</span> np.<span class="bu">abs</span>(fhat_noise) <span class="op">**</span> <span class="dv">2</span> <span class="op">/</span> N</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>PSD_clean <span class="op">=</span> np.<span class="bu">abs</span>(fhat_clean) <span class="op">**</span> <span class="dv">2</span> <span class="op">/</span> N</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>freq <span class="op">=</span> (<span class="dv">1</span> <span class="op">/</span> (dt <span class="op">*</span> N)) <span class="op">*</span> np.arange(N)</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>L <span class="op">=</span> np.arange(<span class="dv">1</span>, np.floor(N <span class="op">/</span> <span class="dv">4</span>), dtype<span class="op">=</span><span class="st">"int"</span>)</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply filter in spectral space</span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a><span class="bu">filter</span> <span class="op">=</span> PSD_noise <span class="op">&gt;</span> <span class="dv">100</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>PSDclean <span class="op">=</span> PSD_noise <span class="op">*</span> <span class="bu">filter</span></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>fhat_filtered <span class="op">=</span> <span class="bu">filter</span> <span class="op">*</span> fhat_noise</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>f_filtered <span class="op">=</span> np.fft.ifft(fhat_filtered)</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Figures</span></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>plt.figure(<span class="dv">0</span>)</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>plt.plot(t, f_noise, <span class="st">":"</span>, label<span class="op">=</span><span class="vs">r"Noisy"</span>)</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>plt.plot(t, f_clean, label<span class="op">=</span><span class="vs">r"Clean"</span>)</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Time [s]"</span>)</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="vs">r"</span><span class="dv">$</span><span class="vs">f</span><span class="dv">$</span><span class="vs">"</span>)</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>plt.xlim(t[<span class="dv">0</span>], t[<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>plt.ylim(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>)</span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>plt.legend(loc<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>plt.gca().set_aspect(<span class="fl">5e-3</span>)</span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>plt.figure(<span class="dv">1</span>)</span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>plt.plot(freq[L], PSD_noise[L], label<span class="op">=</span><span class="vs">r"Noisy"</span>)</span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>plt.plot(freq[L], PSD_clean[L], label<span class="op">=</span><span class="vs">r"Clean"</span>)</span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Frequency [Hz]"</span>)</span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"PSD"</span>)</span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>plt.xlim(<span class="dv">0</span>, <span class="bu">int</span>(freq[L[<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span> <span class="dv">1</span>]))</span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>plt.legend(loc<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>plt.gca().set_aspect(<span class="dv">1</span>)</span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>plt.figure(<span class="dv">3</span>)</span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>plt.plot(t, np.real(f_filtered), label<span class="op">=</span><span class="vs">r"Noisy"</span>)</span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>plt.plot(t, f_clean, label<span class="op">=</span><span class="vs">r"Clean"</span>)</span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Time [s]"</span>)</span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="vs">r"</span><span class="dv">$</span><span class="vs">f</span><span class="dv">$</span><span class="vs">"</span>)</span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a>plt.xlim(t[<span class="dv">0</span>], t[<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a>plt.ylim(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>)</span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a>plt.legend(loc<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a>plt.gca().set_aspect(<span class="fl">5e-3</span>)</span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-fourier_fft_denoise" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fourier_fft_denoise-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-fourier_fft_denoise" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="fig-fourier_fft_denoise-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-fourier_fft_denoise-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="fourier_files/figure-html/fig-fourier_fft_denoise-output-1.svg" class="lightbox" data-gallery="fig-fourier_fft_denoise" title="Figure&nbsp;8.2&nbsp;(a): Original clean signal and noisy signal."><img src="fourier_files/figure-html/fig-fourier_fft_denoise-output-1.svg" class="img-fluid figure-img" data-ref-parent="fig-fourier_fft_denoise"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-fourier_fft_denoise-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Original clean signal and noisy signal.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="cell-output cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-fourier_fft_denoise" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="fig-fourier_fft_denoise-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-fourier_fft_denoise-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="fourier_files/figure-html/fig-fourier_fft_denoise-output-2.svg" class="lightbox" data-gallery="fig-fourier_fft_denoise" title="Figure&nbsp;8.2&nbsp;(b): Scaled square norm of of the Fourier coefficients (PSD), only parts are shown."><img src="fourier_files/figure-html/fig-fourier_fft_denoise-output-2.svg" class="img-fluid figure-img" data-ref-parent="fig-fourier_fft_denoise"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-fourier_fft_denoise-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Scaled square norm of of the Fourier coefficients (PSD), only parts are shown.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="cell-output cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-fourier_fft_denoise" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="fig-fourier_fft_denoise-3" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-fourier_fft_denoise-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="fourier_files/figure-html/fig-fourier_fft_denoise-output-3.svg" class="lightbox" data-gallery="fig-fourier_fft_denoise" title="Figure&nbsp;8.2&nbsp;(c): Original signal and de-noised signal."><img src="fourier_files/figure-html/fig-fourier_fft_denoise-output-3.svg" class="img-fluid figure-img" data-ref-parent="fig-fourier_fft_denoise"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-fourier_fft_denoise-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(c) Original signal and de-noised signal.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fourier_fft_denoise-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8.2: Signal noise filter with FFT.
</figcaption>
</figure>
</div>
<p>As can be seen in the <a href="#fig-fourier_fft_denoise-3" class="quarto-xref">Figure&nbsp;<span>8.2 (c)</span></a>, the reconstruction is not exact. This is due to the fact that the reconstructed frequencies are not matched exactly plus we have some multiples that show up as well. In particular:</p>
<div id="97e43a4d" class="cell" data-execution_count="5">
<div class="cell-output cell-output-display" data-execution_count="4">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Frequency</th>
<th data-quarto-table-cell-role="th">PSD</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>52.0</td>
<td>145.259</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>120.0</td>
<td>230.273</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>3976.0</td>
<td>230.273</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>4044.0</td>
<td>145.259</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Note: For <a href="#fig-fourier_fft_denoise-3" class="quarto-xref">Figure&nbsp;<span>8.2 (c)</span></a> we discarded the imaginary part of the reconstruction.</p>
</div>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-caution no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="exr-fourier-fft-den-self" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 8.2 (Self implementation <a href="#exm-fourier-fft-den" class="quarto-xref">Example&nbsp;<span>8.2</span></a>)</strong></span> Implement the code yourself by filling out the missing sections:</p>
<div id="5c74b0aa" class="cell" data-execution_count="6">
<details class="code-fold">
<summary>Code fragment for implementation.</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">6020</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameters</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> <span class="dv">1024</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>a, b <span class="op">=</span> <span class="dv">0</span>, <span class="dv">1</span> <span class="op">/</span> <span class="dv">4</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> <span class="co"># specify the sample steps for t</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>dt <span class="op">=</span> t[<span class="dv">1</span>] <span class="op">-</span> t[<span class="dv">0</span>]</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>f1 <span class="op">=</span> <span class="dv">50</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>f2 <span class="op">=</span> <span class="dv">120</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>fun <span class="op">=</span> <span class="kw">lambda</span> t: <span class="co"># define the function as described in the example</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>f_clean <span class="op">=</span> fun(t)</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>f_noise <span class="op">=</span> fun(t) <span class="op">+</span> <span class="fl">2.5</span> <span class="op">*</span> np.random.randn(<span class="bu">len</span>(t))</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>fhat_noise <span class="op">=</span> <span class="co"># transform the noisy signal with fft</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>fhat_clean <span class="op">=</span> <span class="co"># transform the clean signal with fft</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>PSD_noise <span class="op">=</span> <span class="co"># Compute the PSD for the noisy signal</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>PSD_clean <span class="op">=</span> <span class="co"># Compute the PSD for the clean signal</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>freq <span class="op">=</span> (<span class="dv">1</span> <span class="op">/</span> (dt <span class="op">*</span> N)) <span class="op">*</span> np.arange(N)</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>L <span class="op">=</span> np.arange(<span class="dv">1</span>, np.floor(N <span class="op">/</span> <span class="dv">4</span>), dtype<span class="op">=</span><span class="st">"int"</span>)</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply filter in spectral space</span></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a><span class="bu">filter</span> <span class="op">=</span> <span class="co"># create the filter for the PSD values grater 100</span></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>PSDclean <span class="op">=</span> <span class="co"># set everything not part of the filter to zero</span></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>fhat_filtered <span class="op">=</span> <span class="co"># apply the filter to the transformed function</span></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>f_filtered <span class="op">=</span> <span class="co"># apply the inverse fft</span></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Figures</span></span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>plt.figure(<span class="dv">0</span>)</span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>plt.plot(t, f_noise, <span class="st">":"</span>, label<span class="op">=</span><span class="vs">r"Noisy"</span>)</span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>plt.plot(t, f_clean, label<span class="op">=</span><span class="vs">r"Clean"</span>)</span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Time [s]"</span>)</span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="vs">r"</span><span class="dv">$</span><span class="vs">f</span><span class="dv">$</span><span class="vs">"</span>)</span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>plt.xlim(t[<span class="dv">0</span>], t[<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>plt.ylim(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>)</span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>plt.legend(loc<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a>plt.gca().set_aspect(<span class="fl">5e-3</span>)</span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a>plt.figure(<span class="dv">1</span>)</span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a>plt.plot(freq[L], PSD_noise[L], label<span class="op">=</span><span class="vs">r"Noisy"</span>)</span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a>plt.plot(freq[L], PSD_clean[L], label<span class="op">=</span><span class="vs">r"Clean"</span>)</span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Frequency [Hz]"</span>)</span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"PSD"</span>)</span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a>plt.xlim(<span class="dv">0</span>, <span class="bu">int</span>(freq[L[<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span> <span class="dv">1</span>]))</span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a>plt.legend(loc<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a>plt.gca().set_aspect(<span class="dv">1</span>)</span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a>plt.figure(<span class="dv">3</span>)</span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a>plt.plot(t, np.real(f_filtered), label<span class="op">=</span><span class="vs">r"Noisy"</span>)</span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a>plt.plot(t, f_clean, label<span class="op">=</span><span class="vs">r"Clean"</span>)</span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Time [s]"</span>)</span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="vs">r"</span><span class="dv">$</span><span class="vs">f</span><span class="dv">$</span><span class="vs">"</span>)</span>
<span id="cb4-57"><a href="#cb4-57" aria-hidden="true" tabindex="-1"></a>plt.xlim(t[<span class="dv">0</span>], t[<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb4-58"><a href="#cb4-58" aria-hidden="true" tabindex="-1"></a>plt.ylim(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>)</span>
<span id="cb4-59"><a href="#cb4-59" aria-hidden="true" tabindex="-1"></a>plt.legend(loc<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb4-60"><a href="#cb4-60" aria-hidden="true" tabindex="-1"></a>plt.gca().set_aspect(<span class="fl">5e-3</span>)</span>
<span id="cb4-61"><a href="#cb4-61" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-caution no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="exr-fourier-fft-den" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 8.3 (DFT vs.&nbsp;FFT)</strong></span> Implement <a href="#exm-fourier-fft-den" class="quarto-xref">Example&nbsp;<span>8.2</span></a> with DFT and FFT such that you can evaluate the runtime and create a plot showing the different runtime as well as check if the two produce the same result.</p>
</div>
</div>
</div>
</div>
<p>For the Fourier transform we stated that the multiplication with <span class="math inline">\(\mathcal{F}\{\partial f\}=\mathrm{i}\omega\mathcal{F}\{f\}\)</span>, similarly we can derive a formula for the numerical derivative of a sampled function by multiplying each entry of the transformed vector by <span class="math inline">\(\mathrm{i}\kappa\)</span> for <span class="math inline">\(\kappa=\tfrac{2\pi k}{N}\)</span>. <span class="math inline">\(\kappa\)</span> is called the discrete wavenumber associated with the component <span class="math inline">\(k\)</span>.</p>
<p>Let us explore this with the example stated in <span class="citation" data-cites="Brunton2022">(<a href="../references.html#ref-Brunton2022" role="doc-biblioref">Brunton and Kutz 2022, 68–69</a>)</span>.</p>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="exm-fourier-fft-spectralderiv" class="theorem example">
<p><span class="theorem-title"><strong>Example 8.3 (Spectral derivative)</strong></span> We compute the so called spectral derivative for the function <span class="math display">\[
\begin{aligned}
f(t) &amp;= \cos(t) \exp\left(-\frac{t^2}{25}\right) \\
\partial_t f(t) &amp;= -\sin(t) \exp\left(-\frac{t^2}{25}\right) - \frac{2}{25}t f(t)
\end{aligned}
\]</span></p>
<p>In order to provide something to compare our results to we also compute the forward Euler finite-differences for the derivative <span class="math display">\[
\partial_t f(t_k) \approx \frac{f(t_{k+1}) - f(t_k)}{t_{k+1} - t_k}.
\]</span></p>
<details class="code-fold">
<summary>Show the code for the figure</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>config InlineBackend.figure_formats <span class="op">=</span> [<span class="st">"svg"</span>]</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameters</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> <span class="dv">128</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>a, b <span class="op">=</span> <span class="op">-</span><span class="dv">15</span>, <span class="dv">15</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>L <span class="op">=</span> b <span class="op">-</span> a</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>fun <span class="op">=</span> <span class="kw">lambda</span> t: np.cos(t) <span class="op">*</span> np.exp(<span class="op">-</span>np.power(t, <span class="dv">2</span>) <span class="op">/</span> <span class="dv">25</span>)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>dfun <span class="op">=</span> <span class="kw">lambda</span> t: <span class="op">-</span>(np.sin(t) <span class="op">*</span> np.exp(<span class="op">-</span>np.power(t, <span class="dv">2</span>) <span class="op">/</span> <span class="dv">25</span>) <span class="op">+</span> (<span class="dv">2</span> <span class="op">/</span> <span class="dv">25</span>) <span class="op">*</span> t <span class="op">*</span> fun(t))</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fD(N, fun, dfun, a, b):</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>    t <span class="op">=</span> np.linspace(a, b, N, endpoint<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>    dt <span class="op">=</span> t[<span class="dv">1</span>] <span class="op">-</span> t[<span class="dv">0</span>]</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>    f <span class="op">=</span> fun(t)</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>    df_DD <span class="op">=</span> np.diff(f) <span class="op">/</span> dt</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>    df_DD <span class="op">=</span> np.append(df_DD, (f[<span class="op">-</span><span class="dv">1</span>] <span class="op">-</span> f[<span class="dv">0</span>]) <span class="op">/</span> dt)</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df_DD, np.linalg.norm(df_DD <span class="op">-</span> dfun(t)) <span class="op">/</span> np.linalg.norm(df_DD)</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> spD(N, fun, dfun, a, b):</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>    t <span class="op">=</span> np.linspace(a, b, N, endpoint<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>    f <span class="op">=</span> fun(t)</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>    fhat <span class="op">=</span> np.fft.fft(f)</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>    kappa <span class="op">=</span> np.fft.fftfreq(N, (b <span class="op">-</span> a) <span class="op">/</span> (N <span class="op">*</span> <span class="dv">2</span> <span class="op">*</span> np.pi))</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>    df_hat <span class="op">=</span> kappa <span class="op">*</span> fhat <span class="op">*</span> (<span class="ot">1j</span>)</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>    df_r <span class="op">=</span> np.fft.ifft(df_hat).real</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df_r, np.linalg.norm(df_r <span class="op">-</span> dfun(t)) <span class="op">/</span> np.linalg.norm(df_r)</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Finite differences</span></span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>df_fD, e <span class="op">=</span> fD(N, fun, dfun, a, b)</span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Spectral derivative</span></span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>df_spD, e <span class="op">=</span> spD(N, fun, dfun, a, b)</span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Figures</span></span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> np.linspace(a, b, N, endpoint<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>plt.figure(<span class="dv">0</span>)</span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>plt.plot(t, dfun(t), label<span class="op">=</span><span class="st">"Exact"</span>)</span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a>plt.plot(t, df_fD, <span class="st">"-."</span>, label<span class="op">=</span><span class="st">"Finite Differences"</span>)</span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>plt.plot(t, df_spD, <span class="st">"--"</span>, label<span class="op">=</span><span class="st">"Spectral"</span>)</span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"t"</span>)</span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="vs">r"</span><span class="dv">$</span><span class="er">\</span><span class="vs">partial_t f</span><span class="dv">$</span><span class="vs">"</span>)</span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a>plt.legend(loc<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a>plt.gca().set_aspect(<span class="dv">5</span>)</span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a>plt.figure(<span class="dv">1</span>)</span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="dv">19</span></span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a>M <span class="op">=</span> <span class="bu">range</span>(<span class="dv">3</span>, n)</span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a>e_spD <span class="op">=</span> np.ones(<span class="bu">len</span>(M))</span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true" tabindex="-1"></a>e_fD <span class="op">=</span> np.ones(<span class="bu">len</span>(M))</span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, j <span class="kw">in</span> <span class="bu">enumerate</span>(M):</span>
<span id="cb5-56"><a href="#cb5-56" aria-hidden="true" tabindex="-1"></a>    _, e_fD[i] <span class="op">=</span> fD(<span class="dv">2</span><span class="op">**</span>j, fun, dfun, a, b)</span>
<span id="cb5-57"><a href="#cb5-57" aria-hidden="true" tabindex="-1"></a>    _, e_spD[i] <span class="op">=</span> spD(<span class="dv">2</span><span class="op">**</span>j, fun, dfun, a, b)</span>
<span id="cb5-58"><a href="#cb5-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-59"><a href="#cb5-59" aria-hidden="true" tabindex="-1"></a>plt.loglog(np.<span class="bu">pow</span>(<span class="dv">2</span>, M), e_fD, label<span class="op">=</span><span class="st">"Finite differences"</span>)</span>
<span id="cb5-60"><a href="#cb5-60" aria-hidden="true" tabindex="-1"></a>plt.loglog(np.<span class="bu">pow</span>(<span class="dv">2</span>, M), e_spD, label<span class="op">=</span><span class="st">"Spectral derivative"</span>)</span>
<span id="cb5-61"><a href="#cb5-61" aria-hidden="true" tabindex="-1"></a>plt.grid()</span>
<span id="cb5-62"><a href="#cb5-62" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"N"</span>)</span>
<span id="cb5-63"><a href="#cb5-63" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Relative Error"</span>)</span>
<span id="cb5-64"><a href="#cb5-64" aria-hidden="true" tabindex="-1"></a>plt.legend(loc<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb5-65"><a href="#cb5-65" aria-hidden="true" tabindex="-1"></a>plt.gca().set_aspect(<span class="fl">2.5e-1</span>)</span>
<span id="cb5-66"><a href="#cb5-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-67"><a href="#cb5-67" aria-hidden="true" tabindex="-1"></a>fun_saw <span class="op">=</span> <span class="kw">lambda</span> t, L: <span class="dv">0</span> <span class="cf">if</span> <span class="bu">abs</span>(t) <span class="op">&gt;</span> L <span class="op">/</span> <span class="dv">4</span> <span class="cf">else</span> (<span class="dv">1</span> <span class="op">-</span> np.sign(t) <span class="op">*</span> t <span class="op">*</span> <span class="dv">4</span> <span class="op">/</span> L)</span>
<span id="cb5-68"><a href="#cb5-68" aria-hidden="true" tabindex="-1"></a>a, b <span class="op">=</span> <span class="op">-</span>np.pi, np.pi</span>
<span id="cb5-69"><a href="#cb5-69" aria-hidden="true" tabindex="-1"></a>L <span class="op">=</span> b <span class="op">-</span> a</span>
<span id="cb5-70"><a href="#cb5-70" aria-hidden="true" tabindex="-1"></a>fun2 <span class="op">=</span> <span class="kw">lambda</span> t: np.fromiter(<span class="bu">map</span>(<span class="kw">lambda</span> t: fun_saw(t, L), t), t.dtype)</span>
<span id="cb5-71"><a href="#cb5-71" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> <span class="dv">2</span><span class="op">**</span><span class="dv">10</span></span>
<span id="cb5-72"><a href="#cb5-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-73"><a href="#cb5-73" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> np.linspace(a, b, N, endpoint<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb5-74"><a href="#cb5-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-75"><a href="#cb5-75" aria-hidden="true" tabindex="-1"></a>plt.figure(<span class="dv">2</span>)</span>
<span id="cb5-76"><a href="#cb5-76" aria-hidden="true" tabindex="-1"></a>df_spD, _ <span class="op">=</span> spD(N, fun2, fun2, a, b)</span>
<span id="cb5-77"><a href="#cb5-77" aria-hidden="true" tabindex="-1"></a>df_fD, _ <span class="op">=</span> fD(N, fun2, fun2, a, b)</span>
<span id="cb5-78"><a href="#cb5-78" aria-hidden="true" tabindex="-1"></a>plt.plot(t, fun2(t), label<span class="op">=</span><span class="vs">r"Function </span><span class="dv">$</span><span class="vs">f</span><span class="dv">$</span><span class="vs">"</span>)</span>
<span id="cb5-79"><a href="#cb5-79" aria-hidden="true" tabindex="-1"></a>plt.plot(t, df_fD, <span class="st">"-."</span>, label<span class="op">=</span><span class="st">"Finite derivative"</span>)</span>
<span id="cb5-80"><a href="#cb5-80" aria-hidden="true" tabindex="-1"></a>plt.plot(t, df_spD, <span class="st">"--"</span>, label<span class="op">=</span><span class="st">"Spectral derivative"</span>)</span>
<span id="cb5-81"><a href="#cb5-81" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"t"</span>)</span>
<span id="cb5-82"><a href="#cb5-82" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="vs">r"</span><span class="dv">$</span><span class="vs">f, </span><span class="er">\</span><span class="vs">partial_t f</span><span class="dv">$</span><span class="vs">"</span>)</span>
<span id="cb5-83"><a href="#cb5-83" aria-hidden="true" tabindex="-1"></a>plt.xlim(<span class="op">-</span><span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb5-84"><a href="#cb5-84" aria-hidden="true" tabindex="-1"></a>plt.legend(loc<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb5-85"><a href="#cb5-85" aria-hidden="true" tabindex="-1"></a>plt.gca().set_aspect(<span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-fourier_fft_spectralderivative" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fourier_fft_spectralderivative-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-fourier_fft_spectralderivative" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="fig-fourier_fft_spectralderivative-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-fourier_fft_spectralderivative-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="fourier_files/figure-html/fig-fourier_fft_spectralderivative-output-1.svg" class="lightbox" data-gallery="fig-fourier_fft_spectralderivative" title="Figure&nbsp;8.3&nbsp;(a): Computation of the derivative with different methods (Exact and spectral are almost the same)."><img src="fourier_files/figure-html/fig-fourier_fft_spectralderivative-output-1.svg" class="img-fluid figure-img" data-ref-parent="fig-fourier_fft_spectralderivative"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-fourier_fft_spectralderivative-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Computation of the derivative with different methods (Exact and spectral are almost the same).
</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="cell-output cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-fourier_fft_spectralderivative" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="fig-fourier_fft_spectralderivative-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-fourier_fft_spectralderivative-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="fourier_files/figure-html/fig-fourier_fft_spectralderivative-output-2.svg" class="lightbox" data-gallery="fig-fourier_fft_spectralderivative" title="Figure&nbsp;8.3&nbsp;(b): Accuracy of the methods for computing the derivative."><img src="fourier_files/figure-html/fig-fourier_fft_spectralderivative-output-2.svg" class="img-fluid figure-img" data-ref-parent="fig-fourier_fft_spectralderivative"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-fourier_fft_spectralderivative-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Accuracy of the methods for computing the derivative.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="cell-output cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-fourier_fft_spectralderivative" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="fig-fourier_fft_spectralderivative-3" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-fourier_fft_spectralderivative-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="fourier_files/figure-html/fig-fourier_fft_spectralderivative-output-3.svg" class="lightbox" data-gallery="fig-fourier_fft_spectralderivative" title="Figure&nbsp;8.3&nbsp;(c): Gibbs phenomenon for the spectral derivative for discontinuous functions."><img src="fourier_files/figure-html/fig-fourier_fft_spectralderivative-output-3.svg" class="img-fluid figure-img" data-ref-parent="fig-fourier_fft_spectralderivative"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-fourier_fft_spectralderivative-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(c) Gibbs phenomenon for the spectral derivative for discontinuous functions.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fourier_fft_spectralderivative-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8.3: Computing the derivative of a function.
</figcaption>
</figure>
</div>
<p>As can be seen in <a href="#fig-fourier_fft_spectralderivative-2" class="quarto-xref">Figure&nbsp;<span>8.3 (b)</span></a> we can reduce the error of both methods by increasing <span class="math inline">\(N\)</span>. Nevertheless, the spectral method is more accurate and converges faster.</p>
</div>
</div>
</div>
</div>
<p>In <a href="../matrixdc/eigen.html#sec-eigen-lode" class="quarto-xref"><span>Section 3.1.2</span></a> we have already seen how the eigendecomposition can be used to compute the solution of ordinary differential equations by changing the basis and transforming the equation into a basis that can be handled in a straightforward manner. The same is true with the Fourier transformation.</p>
<p>As mentioned before, Fourier introduced it to solve the heat equation and we will do the same.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>Above we have always transformed the <em>time</em> component of a function into the frequency domain via FFT. In the next example we have the time evolution of a signal and therefore the function depends on time and space. We apply the FFT to the space component to compute the derivative in <em>frequency</em> domain w.r.t. the transformed variable.</p>
<p>This automatically results in periodic boundary conditions for the following examples, see especially <a href="#exm-fourier-fft-advection" class="quarto-xref">Example&nbsp;<span>8.5</span></a>.</p>
</div>
</div>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="exm-fourier-fft-heat" class="theorem example">
<p><span class="theorem-title"><strong>Example 8.4 (Heat Equation)</strong></span> The heat equation in 1D is given by <span class="math display">\[
\dot{u}(t, x) = \alpha^2 \partial_x^2 u(\tau, x),
\]</span> for <span class="math inline">\(u(t, x)\)</span> as the temperature distribution in space (<span class="math inline">\(x\)</span>) and time (<span class="math inline">\(t\)</span>). By applying the Fourier transform we get <span class="math inline">\(\mathcal{F}\{u(t,x)\}=\hat{u}(t, \omega)\)</span> and <span class="math display">\[
\dot{\hat{u}}(t, \omega) = - \alpha^2\omega^2\hat{u}(t, \omega).
\]</span> This transformed the partial differential equation into an ordinary differential equation and we can solve it for each fixed frequency <span class="math inline">\(\omega\)</span> as <span class="math display">\[
\hat{u}(t, \omega) = \mathrm{e}^{-\alpha^2\omega^2 t} \hat{u}(0, \omega).
\]</span> where <span class="math inline">\(\hat{u}(0, \omega)\)</span> is nothing else than the Fourier transform of the initial temperature distribution at time <span class="math inline">\(t=0\)</span>. To compute the inverse Fourier transform we can make use of the convolution property introduced above.</p>
<p><span class="math display">\[
\begin{aligned}
u(t, x) &amp;= \mathcal{F}^{-1}\{\hat{u}(t, \omega)\} = \mathcal{F}^{-1}\{\mathrm{e}^{-\alpha^2\omega^2 t}\} \ast u(0, x) \\
&amp;= \frac{1}{2 \alpha \sqrt{\pi t}} \mathrm{e}^{-\tfrac{x^2}{4\alpha^2t}} \ast u(0, x).
\end{aligned}
\]</span></p>
<p>For the numerical computation it is more convenient to stay in the frequency domain and use <span class="math inline">\(\kappa\)</span> as before.</p>
<p>The majority of the following code is from <span class="citation" data-cites="Brunton2022">(<a href="../references.html#ref-Brunton2022" role="doc-biblioref">Brunton and Kutz 2022</a>, Code 2.5 and Code 2.6)</span>.</p>
<details class="code-fold">
<summary>Show the code for the figure</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.integrate <span class="im">import</span> odeint</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>config InlineBackend.figure_formats <span class="op">=</span> [<span class="st">"svg"</span>]</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>alpha <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>a, b <span class="op">=</span> <span class="op">-</span><span class="dv">50</span>, <span class="dv">50</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>L <span class="op">=</span> b <span class="op">-</span> a</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(a, b, N, endpoint<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>dx <span class="op">=</span> x[<span class="dv">1</span>] <span class="op">-</span> x[<span class="dv">0</span>]</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Define discrete wavenumbers</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="co"># kappa = 2 * np.pi * np.fft.fftfreq(N, d=dx)</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>kappa <span class="op">=</span> np.fft.fftfreq(N, (b <span class="op">-</span> a) <span class="op">/</span> (N <span class="op">*</span> <span class="dv">2</span> <span class="op">*</span> np.pi))</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Initial condition</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>u0 <span class="op">=</span> np.zeros_like(x)</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>u0[np.<span class="bu">abs</span>(x) <span class="op">&lt;</span> <span class="dv">10</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>u0hat <span class="op">=</span> np.fft.fft(u0)</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate in Fourier frequency domain</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>dt <span class="op">=</span> <span class="fl">0.001</span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>T <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">10</span>, dt)</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>fun <span class="op">=</span> <span class="kw">lambda</span> t, x: <span class="op">-</span>(alpha<span class="op">**</span><span class="dv">2</span>) <span class="op">*</span> (np.power(kappa, <span class="dv">2</span>)) <span class="op">*</span> x</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>euler <span class="op">=</span> <span class="kw">lambda</span> y, dt, t, fun: y <span class="op">+</span> dt <span class="op">*</span> fun(t, y)</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>uhat <span class="op">=</span> np.zeros((<span class="bu">len</span>(T), <span class="bu">len</span>(u0hat)), dtype<span class="op">=</span><span class="st">"complex"</span>)</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>uhat[<span class="dv">0</span>, :] <span class="op">=</span> u0hat</span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, t <span class="kw">in</span> <span class="bu">enumerate</span>(T[<span class="dv">1</span>:]):</span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>    uhat[i <span class="op">+</span> <span class="dv">1</span>, :] <span class="op">=</span> euler(uhat[i, :], dt, t, fun)</span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>u <span class="op">=</span> np.zeros_like(uhat)</span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(T)):</span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>    u[k, :] <span class="op">=</span> np.fft.ifft(uhat[k, :])</span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a>u <span class="op">=</span> u.real</span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.figure()</span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> fig.add_subplot(projection<span class="op">=</span><span class="st">"3d"</span>)</span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a><span class="co"># ax.view_init(elev=45, azim=-20, roll=0)</span></span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="vs">r"</span><span class="dv">$</span><span class="vs">x</span><span class="dv">$</span><span class="vs">"</span>)</span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="vs">r"</span><span class="dv">$</span><span class="vs">t</span><span class="dv">$</span><span class="vs">"</span>)</span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a>ax.set_zlabel(<span class="vs">r"</span><span class="dv">$</span><span class="vs">u</span><span class="kw">(</span><span class="vs">t, x</span><span class="kw">)</span><span class="dv">$</span><span class="vs">"</span>)</span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a>ax.set_zticks([])</span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a>u_plot <span class="op">=</span> u[<span class="dv">0</span> : <span class="op">-</span><span class="dv">1</span> : <span class="bu">int</span>(<span class="dv">1</span> <span class="op">/</span> dt), :]</span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(u_plot.shape[<span class="dv">0</span>]):</span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true" tabindex="-1"></a>    ys <span class="op">=</span> j <span class="op">*</span> np.ones(u_plot.shape[<span class="dv">1</span>])</span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true" tabindex="-1"></a>    ax.plot(x, ys, u_plot[j, :])</span>
<span id="cb6-54"><a href="#cb6-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-55"><a href="#cb6-55" aria-hidden="true" tabindex="-1"></a><span class="co"># Image plot</span></span>
<span id="cb6-56"><a href="#cb6-56" aria-hidden="true" tabindex="-1"></a>plt.figure()</span>
<span id="cb6-57"><a href="#cb6-57" aria-hidden="true" tabindex="-1"></a>plt.imshow(np.flipud(u[<span class="dv">0</span>:<span class="op">-</span><span class="dv">1</span>:<span class="dv">100</span>]), aspect<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb6-58"><a href="#cb6-58" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="vs">r"</span><span class="dv">$</span><span class="vs">x</span><span class="dv">$</span><span class="vs">"</span>)</span>
<span id="cb6-59"><a href="#cb6-59" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="vs">r"</span><span class="dv">$</span><span class="vs">t </span><span class="ch">\t</span><span class="vs">o</span><span class="dv">$</span><span class="vs">"</span>)</span>
<span id="cb6-60"><a href="#cb6-60" aria-hidden="true" tabindex="-1"></a>plt.gca().axes.get_xaxis().set_ticks([])</span>
<span id="cb6-61"><a href="#cb6-61" aria-hidden="true" tabindex="-1"></a>plt.gca().axes.get_yaxis().set_ticks([])</span>
<span id="cb6-62"><a href="#cb6-62" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-fourier_fft_heat" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fourier_fft_heat-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-fourier_fft_heat" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="fig-fourier_fft_heat-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-fourier_fft_heat-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="fourier_files/figure-html/fig-fourier_fft_heat-output-1.svg" class="lightbox" data-gallery="fig-fourier_fft_heat" title="Figure&nbsp;8.4&nbsp;(a): Evolution of the heat equation in time."><img src="fourier_files/figure-html/fig-fourier_fft_heat-output-1.svg" class="img-fluid figure-img" data-ref-parent="fig-fourier_fft_heat"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-fourier_fft_heat-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Evolution of the heat equation in time.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="cell-output cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-fourier_fft_heat" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="fig-fourier_fft_heat-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-fourier_fft_heat-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="fourier_files/figure-html/fig-fourier_fft_heat-output-2.svg" class="lightbox" data-gallery="fig-fourier_fft_heat" title="Figure&nbsp;8.4&nbsp;(b): x-t diagram of the transport equation."><img src="fourier_files/figure-html/fig-fourier_fft_heat-output-2.svg" class="img-fluid figure-img" data-ref-parent="fig-fourier_fft_heat"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-fourier_fft_heat-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) x-t diagram of the transport equation.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fourier_fft_heat-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8.4: Simulation of the heat equation in 1D.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-caution no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="exr-fourier-fft-heat-self" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 8.4 (Self implementation <a href="#exm-fourier-fft-heat" class="quarto-xref">Example&nbsp;<span>8.4</span></a>)</strong></span> Implement the code yourself by filling out the missing sections:</p>
<div id="533b30dd" class="cell" data-execution_count="9">
<details class="code-fold">
<summary>Code fragment for implementation.</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>alpha <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>a, b <span class="op">=</span> <span class="op">-</span><span class="dv">50</span>, <span class="dv">50</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>L <span class="op">=</span> b <span class="op">-</span> a</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(a, b, N, endpoint<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>dx <span class="op">=</span> x[<span class="dv">1</span>] <span class="op">-</span> x[<span class="dv">0</span>]</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Define discrete wavenumbers</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>kappa <span class="op">=</span> np.fft.fftfreq(N, (b <span class="op">-</span> a) <span class="op">/</span> (N <span class="op">*</span> <span class="dv">2</span> <span class="op">*</span> np.pi))</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Initial condition</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>u0 <span class="op">=</span> np.zeros_like(x)</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>u0[np.<span class="bu">abs</span>(x) <span class="op">&lt;</span> <span class="dv">10</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>u0hat <span class="op">=</span> np.fft.fft(u0)</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate in Fourier frequency domain</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>dt <span class="op">=</span> <span class="fl">0.001</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>T <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">10</span>, dt)</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>fun <span class="op">=</span> <span class="kw">lambda</span> t, x: <span class="co">#right hand side for the euler function</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>euler <span class="op">=</span> <span class="kw">lambda</span> y, dt, t, fun: <span class="co"># euler step</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>uhat <span class="op">=</span> np.zeros((<span class="bu">len</span>(T), <span class="bu">len</span>(u0hat)), dtype<span class="op">=</span><span class="st">"complex"</span>)</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>uhat[<span class="dv">0</span>, :] <span class="op">=</span> u0hat</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, t <span class="kw">in</span> <span class="bu">enumerate</span>(T[<span class="dv">1</span>:]):</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>    uhat[i <span class="op">+</span> <span class="dv">1</span>, :] <span class="op">=</span> euler(uhat[i, :], dt, t, fun)</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>u <span class="op">=</span> np.zeros_like(uhat)</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(T)):</span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>    u[k, :] <span class="op">=</span> np.fft.ifft(uhat[k, :])</span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>u <span class="op">=</span> u.real</span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Waterfall plot</span></span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.figure()</span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> fig.add_subplot(<span class="dv">111</span>, projection<span class="op">=</span><span class="st">"3d"</span>)</span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="vs">r"</span><span class="dv">$</span><span class="vs">x</span><span class="dv">$</span><span class="vs">"</span>)</span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="vs">r"</span><span class="dv">$</span><span class="vs">t</span><span class="dv">$</span><span class="vs">"</span>)</span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>ax.set_zlabel(<span class="vs">r"</span><span class="dv">$</span><span class="vs">u</span><span class="kw">(</span><span class="vs">t, x</span><span class="kw">)</span><span class="dv">$</span><span class="vs">"</span>)</span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>ax.set_zticks([])</span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a>u_plot <span class="op">=</span> u[<span class="dv">0</span> : <span class="op">-</span><span class="dv">1</span> : <span class="bu">int</span>(<span class="dv">1</span> <span class="op">/</span> dt), :]</span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(u_plot.shape[<span class="dv">0</span>]):</span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a>    ys <span class="op">=</span> j <span class="op">*</span> np.ones(u_plot.shape[<span class="dv">1</span>])</span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a>    ax.plot(x, ys, u_plot[j, :])</span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a><span class="co"># Image plot</span></span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a>plt.figure()</span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a>plt.imshow(np.flipud(u[<span class="dv">0</span>:<span class="op">-</span><span class="dv">1</span>:<span class="dv">100</span>]), aspect<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="vs">r"</span><span class="dv">$</span><span class="vs">x</span><span class="dv">$</span><span class="vs">"</span>)</span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="vs">r"</span><span class="dv">$</span><span class="vs">t </span><span class="ch">\t</span><span class="vs">o</span><span class="dv">$</span><span class="vs">"</span>)</span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true" tabindex="-1"></a>plt.gca().axes.get_xaxis().set_ticks([])</span>
<span id="cb7-57"><a href="#cb7-57" aria-hidden="true" tabindex="-1"></a>plt.gca().axes.get_yaxis().set_ticks([])</span>
<span id="cb7-58"><a href="#cb7-58" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</div>
<p>Next, we look at the transport equation.</p>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="exm-fourier-fft-advection" class="theorem example">
<p><span class="theorem-title"><strong>Example 8.5 (Transport or advection)</strong></span> The transport equation in 1D is given by <span class="math display">\[
\dot{u} = - c \partial_x u.
\]</span> It is called the transport equation, as the initial value simply propagates in time to the right hand side of the domain with speed <span class="math inline">\(c\)</span>, i.e.&nbsp;<span class="math inline">\(u(t, x) = u(0, x -c t)\)</span>. The solution is simply computed by exchanging the right hand side from the above code.</p>
<p><strong>Note</strong>: In this example, we see the periodic boundary conditions implicitly provided by the space discretisation via Fourier transform.</p>
<p>The majority of the following code is from <span class="citation" data-cites="Brunton2022">(<a href="../references.html#ref-Brunton2022" role="doc-biblioref">Brunton and Kutz 2022</a>, Code 2.5 and Code 2.6)</span>.</p>
<details class="code-fold">
<summary>Show the code for the figure</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.integrate <span class="im">import</span> odeint</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>config InlineBackend.figure_formats <span class="op">=</span> [<span class="st">"svg"</span>]</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>c <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>a, b <span class="op">=</span> <span class="op">-</span><span class="dv">20</span>, <span class="dv">20</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>L <span class="op">=</span> b <span class="op">-</span> a</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(a, b, N, endpoint<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>dx <span class="op">=</span> x[<span class="dv">1</span>] <span class="op">-</span> x[<span class="dv">0</span>]</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Define discrete wavenumbers</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="co"># kappa = 2 * np.pi * np.fft.fftfreq(N, d=dx)</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>kappa <span class="op">=</span> np.fft.fftfreq(N, (b <span class="op">-</span> a) <span class="op">/</span> (N <span class="op">*</span> <span class="dv">2</span> <span class="op">*</span> np.pi))</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Initial condition</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>u0 <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> np.cosh(x)</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>u0hat <span class="op">=</span> np.fft.fft(u0)</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a><span class="co"># SciPy's odeint function doesn't play well with complex numbers,</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a><span class="co"># so we recast the state u0hat from an N-element complex vector</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a><span class="co"># to a 2N-element real vector</span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>u0hat_ri <span class="op">=</span> np.concatenate((u0hat.real, u0hat.imag))</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate in Fourier frequency domain</span></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>dt <span class="op">=</span> <span class="fl">0.025</span></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>T <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">600</span> <span class="op">*</span> dt, dt)</span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> rhsWave(uhat_ri, t, kappa, c):</span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>    uhat <span class="op">=</span> uhat_ri[:N] <span class="op">+</span> (<span class="ot">1j</span>) <span class="op">*</span> uhat_ri[N:]</span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>    d_uhat <span class="op">=</span> <span class="op">-</span>c <span class="op">*</span> (<span class="ot">1j</span>) <span class="op">*</span> kappa <span class="op">*</span> uhat</span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>    d_uhat_ri <span class="op">=</span> np.concatenate((d_uhat.real, d_uhat.imag)).astype(<span class="st">"float64"</span>)</span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> d_uhat_ri</span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a>uhat_ri <span class="op">=</span> odeint(rhsWave, u0hat_ri, T, args<span class="op">=</span>(kappa, c))</span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a>uhat <span class="op">=</span> uhat_ri[:, :N] <span class="op">+</span> (<span class="ot">1j</span>) <span class="op">*</span> uhat_ri[:, N:]</span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a>u <span class="op">=</span> np.zeros_like(uhat)</span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(T)):</span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a>    u[k, :] <span class="op">=</span> np.fft.ifft(uhat[k, :])</span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a>u <span class="op">=</span> u.real</span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Waterfall plot</span></span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.figure()</span>
<span id="cb8-52"><a href="#cb8-52" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> fig.add_subplot(projection<span class="op">=</span><span class="st">"3d"</span>)</span>
<span id="cb8-53"><a href="#cb8-53" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="vs">r"</span><span class="dv">$</span><span class="vs">x</span><span class="dv">$</span><span class="vs">"</span>)</span>
<span id="cb8-54"><a href="#cb8-54" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="vs">r"</span><span class="dv">$</span><span class="vs">t</span><span class="dv">$</span><span class="vs">"</span>)</span>
<span id="cb8-55"><a href="#cb8-55" aria-hidden="true" tabindex="-1"></a>ax.set_zlabel(<span class="vs">r"</span><span class="dv">$</span><span class="vs">u</span><span class="kw">(</span><span class="vs">t, x</span><span class="kw">)</span><span class="dv">$</span><span class="vs">"</span>)</span>
<span id="cb8-56"><a href="#cb8-56" aria-hidden="true" tabindex="-1"></a>ax.set_zticks([])</span>
<span id="cb8-57"><a href="#cb8-57" aria-hidden="true" tabindex="-1"></a>u_plot <span class="op">=</span> u[<span class="dv">0</span>:<span class="op">-</span><span class="dv">1</span>:<span class="dv">60</span>, :]</span>
<span id="cb8-58"><a href="#cb8-58" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(u_plot.shape[<span class="dv">0</span>]):</span>
<span id="cb8-59"><a href="#cb8-59" aria-hidden="true" tabindex="-1"></a>    ys <span class="op">=</span> j <span class="op">*</span> np.ones(u_plot.shape[<span class="dv">1</span>])</span>
<span id="cb8-60"><a href="#cb8-60" aria-hidden="true" tabindex="-1"></a>    ax.plot(x, ys, u_plot[j, :])</span>
<span id="cb8-61"><a href="#cb8-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-62"><a href="#cb8-62" aria-hidden="true" tabindex="-1"></a><span class="co"># Image plot</span></span>
<span id="cb8-63"><a href="#cb8-63" aria-hidden="true" tabindex="-1"></a>plt.figure()</span>
<span id="cb8-64"><a href="#cb8-64" aria-hidden="true" tabindex="-1"></a>plt.imshow(np.flipud(u), aspect<span class="op">=</span><span class="fl">1.5</span>)</span>
<span id="cb8-65"><a href="#cb8-65" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="vs">r"</span><span class="dv">$</span><span class="vs">x</span><span class="dv">$</span><span class="vs">"</span>)</span>
<span id="cb8-66"><a href="#cb8-66" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="vs">r"</span><span class="dv">$</span><span class="vs">t </span><span class="ch">\t</span><span class="vs">o</span><span class="dv">$</span><span class="vs">"</span>)</span>
<span id="cb8-67"><a href="#cb8-67" aria-hidden="true" tabindex="-1"></a>plt.gca().axes.get_xaxis().set_ticks([])</span>
<span id="cb8-68"><a href="#cb8-68" aria-hidden="true" tabindex="-1"></a>plt.gca().axes.get_yaxis().set_ticks([])</span>
<span id="cb8-69"><a href="#cb8-69" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-fourier_fft_advection" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fourier_fft_advection-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-fourier_fft_advection" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="fig-fourier_fft_advection-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-fourier_fft_advection-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="fourier_files/figure-html/fig-fourier_fft_advection-output-1.svg" class="lightbox" data-gallery="fig-fourier_fft_advection" title="Figure&nbsp;8.5&nbsp;(a): Evolution of the transport equation in time."><img src="fourier_files/figure-html/fig-fourier_fft_advection-output-1.svg" class="img-fluid figure-img" data-ref-parent="fig-fourier_fft_advection"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-fourier_fft_advection-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Evolution of the transport equation in time.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="cell-output cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-fourier_fft_advection" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="fig-fourier_fft_advection-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-fourier_fft_advection-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="fourier_files/figure-html/fig-fourier_fft_advection-output-2.svg" class="lightbox" data-gallery="fig-fourier_fft_advection" title="Figure&nbsp;8.5&nbsp;(b): x-t diagram of the transport equation."><img src="fourier_files/figure-html/fig-fourier_fft_advection-output-2.svg" class="img-fluid figure-img" data-ref-parent="fig-fourier_fft_advection"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-fourier_fft_advection-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) x-t diagram of the transport equation.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fourier_fft_advection-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8.5: Computing the derivative of a function
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-caution no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="exr-fourier-fft-advection-self" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 8.5 (Self implementation <a href="#exm-fourier-fft-advection" class="quarto-xref">Example&nbsp;<span>8.5</span></a>)</strong></span> Implement the code yourself by filling out the missing sections:</p>
<div id="6a082108" class="cell" data-execution_count="11">
<details class="code-fold">
<summary>Code fragment for implementation.</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.integrate <span class="im">import</span> odeint</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>config InlineBackend.figure_formats <span class="op">=</span> [<span class="st">"svg"</span>]</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>c <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>a, b <span class="op">=</span> <span class="op">-</span><span class="dv">20</span>, <span class="dv">20</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>L <span class="op">=</span> b <span class="op">-</span> a</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(a, b, N, endpoint<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>dx <span class="op">=</span> x[<span class="dv">1</span>] <span class="op">-</span> x[<span class="dv">0</span>]</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Define discrete wave numbers</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>kappa <span class="op">=</span> <span class="co"># use np.fft.fftfreq to compute the wave numbers</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Initial condition</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>u0 <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> np.cosh(x)</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>u0hat <span class="op">=</span> np.fft.fft(u0)</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a><span class="co"># SciPy's odeint function doesn't play well with complex numbers,</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a><span class="co"># so we recast the state u0hat from an N-element complex vector</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a><span class="co"># to a 2N-element real vector</span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>u0hat_ri <span class="op">=</span> np.concatenate((u0hat.real, u0hat.imag))</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate in Fourier frequency domain</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>dt <span class="op">=</span> <span class="fl">0.025</span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>T <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">600</span> <span class="op">*</span> dt, dt)</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> rhsWave(uhat_ri, t, kappa, c):</span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>    uhat <span class="op">=</span> uhat_ri[:N] <span class="op">+</span> (<span class="ot">1j</span>) <span class="op">*</span> uhat_ri[N:]</span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>    d_uhat <span class="op">=</span>  <span class="co">#derivative with parameter in fourier space</span></span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>    d_uhat_ri <span class="op">=</span> np.concatenate((d_uhat.real, d_uhat.imag)).astype(<span class="st">"float64"</span>)</span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> d_uhat_ri</span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>uhat_ri <span class="op">=</span> odeint(rhsWave, u0hat_ri, T, args<span class="op">=</span>(kappa, c))</span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>uhat <span class="op">=</span> uhat_ri[:, :N] <span class="op">+</span> (<span class="ot">1j</span>) <span class="op">*</span> uhat_ri[:, N:]</span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>u <span class="op">=</span> np.zeros_like(uhat)</span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(T)):</span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a>    u[k, :] <span class="op">=</span> np.fft.ifft(uhat[k, :])</span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a>u <span class="op">=</span> u.real</span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Waterfall plot</span></span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.figure()</span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> fig.add_subplot(projection<span class="op">=</span><span class="st">"3d"</span>)</span>
<span id="cb9-52"><a href="#cb9-52" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="vs">r"</span><span class="dv">$</span><span class="vs">x</span><span class="dv">$</span><span class="vs">"</span>)</span>
<span id="cb9-53"><a href="#cb9-53" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="vs">r"</span><span class="dv">$</span><span class="vs">t</span><span class="dv">$</span><span class="vs">"</span>)</span>
<span id="cb9-54"><a href="#cb9-54" aria-hidden="true" tabindex="-1"></a>ax.set_zlabel(<span class="vs">r"</span><span class="dv">$</span><span class="vs">u</span><span class="kw">(</span><span class="vs">t, x</span><span class="kw">)</span><span class="dv">$</span><span class="vs">"</span>)</span>
<span id="cb9-55"><a href="#cb9-55" aria-hidden="true" tabindex="-1"></a>ax.set_zticks([])</span>
<span id="cb9-56"><a href="#cb9-56" aria-hidden="true" tabindex="-1"></a>u_plot <span class="op">=</span> u[<span class="dv">0</span>:<span class="op">-</span><span class="dv">1</span>:<span class="dv">60</span>, :]</span>
<span id="cb9-57"><a href="#cb9-57" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(u_plot.shape[<span class="dv">0</span>]):</span>
<span id="cb9-58"><a href="#cb9-58" aria-hidden="true" tabindex="-1"></a>    ys <span class="op">=</span> j <span class="op">*</span> np.ones(u_plot.shape[<span class="dv">1</span>])</span>
<span id="cb9-59"><a href="#cb9-59" aria-hidden="true" tabindex="-1"></a>    ax.plot(x, ys, u_plot[j, :])</span>
<span id="cb9-60"><a href="#cb9-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-61"><a href="#cb9-61" aria-hidden="true" tabindex="-1"></a><span class="co"># Image plot</span></span>
<span id="cb9-62"><a href="#cb9-62" aria-hidden="true" tabindex="-1"></a>plt.figure()</span>
<span id="cb9-63"><a href="#cb9-63" aria-hidden="true" tabindex="-1"></a>plt.imshow(np.flipud(u), aspect<span class="op">=</span><span class="fl">1.5</span>)</span>
<span id="cb9-64"><a href="#cb9-64" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="vs">r"</span><span class="dv">$</span><span class="vs">x</span><span class="dv">$</span><span class="vs">"</span>)</span>
<span id="cb9-65"><a href="#cb9-65" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="vs">r"</span><span class="dv">$</span><span class="vs">t </span><span class="ch">\t</span><span class="vs">o</span><span class="dv">$</span><span class="vs">"</span>)</span>
<span id="cb9-66"><a href="#cb9-66" aria-hidden="true" tabindex="-1"></a>plt.gca().axes.get_xaxis().set_ticks([])</span>
<span id="cb9-67"><a href="#cb9-67" aria-hidden="true" tabindex="-1"></a>plt.gca().axes.get_yaxis().set_ticks([])</span>
<span id="cb9-68"><a href="#cb9-68" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</div>
<p>To increase complexity from these simple equations we move to the nonlinear Burger’s equation which is a combination of the two above and an example that produces shock waves in fluids.</p>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="exm-fourier-fft-burger" class="theorem example">
<p><span class="theorem-title"><strong>Example 8.6 (Burger’s equation)</strong></span> Burger’s equation in 1D is given by <span class="math display">\[
\dot{u} + u \partial_x u = \nu \partial_x^2 u.
\]</span> The equation consists of a nonlinear convection part <span class="math inline">\(u \partial_t u\)</span> as well as diffusion. The convection part is designed in such a way that larger amplitudes travel faster and therefore causes a shock wave to form.</p>
<p>Regarding the solution of this equation, the interesting part is that we need to map back and forth between the Fourier space and time space to apply the nonlinearity.</p>
<p>This example is also very useful to test the capabilities of your solver as by decreasing the diffusion factor further and further we can approach an infinitely steep shock and in theory it can break like an ocean wave.</p>
<p>The majority of the following code is from <span class="citation" data-cites="Brunton2022">(<a href="../references.html#ref-Brunton2022" role="doc-biblioref">Brunton and Kutz 2022</a>, Code 2.5 and Code 2.6)</span>.</p>
<details class="code-fold">
<summary>Show the code for the figure</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.integrate <span class="im">import</span> odeint</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>config InlineBackend.figure_formats <span class="op">=</span> [<span class="st">"svg"</span>]</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>nu <span class="op">=</span> <span class="fl">0.001</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>a, b <span class="op">=</span> <span class="op">-</span><span class="dv">10</span>, <span class="dv">10</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>L <span class="op">=</span> b <span class="op">-</span> a</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(a, b, N, endpoint<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>dx <span class="op">=</span> x[<span class="dv">1</span>] <span class="op">-</span> x[<span class="dv">0</span>]</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Define discrete wavenumbers</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="co"># kappa = 2 * np.pi * np.fft.fftfreq(N, d=dx)</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>kappa <span class="op">=</span> np.fft.fftfreq(N, (b <span class="op">-</span> a) <span class="op">/</span> (N <span class="op">*</span> <span class="dv">2</span> <span class="op">*</span> np.pi))</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Initial condition</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>u0 <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> np.cosh(x)</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate in Fourier frequency domain</span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>dt <span class="op">=</span> <span class="fl">0.025</span></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>T <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">100</span> <span class="op">*</span> dt, dt)</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> rhsBurgers(u, t, kappa, nu):</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>    uhat <span class="op">=</span> np.fft.fft(u)</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>    d_uhat <span class="op">=</span> (<span class="ot">1j</span>) <span class="op">*</span> kappa <span class="op">*</span> uhat</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>    dd_uhat <span class="op">=</span> <span class="op">-</span>np.power(kappa, <span class="dv">2</span>) <span class="op">*</span> uhat</span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>    d_u <span class="op">=</span> np.fft.ifft(d_uhat)</span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>    dd_u <span class="op">=</span> np.fft.ifft(dd_uhat)</span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>    du_dt <span class="op">=</span> <span class="op">-</span>u <span class="op">*</span> d_u <span class="op">+</span> nu <span class="op">*</span> dd_u</span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> du_dt.real</span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>u <span class="op">=</span> odeint(rhsBurgers, u0, T, args<span class="op">=</span>(kappa, nu))</span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Waterfall plot</span></span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.figure()</span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> fig.add_subplot(<span class="dv">111</span>, projection<span class="op">=</span><span class="st">"3d"</span>)</span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="vs">r"</span><span class="dv">$</span><span class="vs">x</span><span class="dv">$</span><span class="vs">"</span>)</span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="vs">r"</span><span class="dv">$</span><span class="vs">t</span><span class="dv">$</span><span class="vs">"</span>)</span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a>ax.set_zlabel(<span class="vs">r"</span><span class="dv">$</span><span class="vs">u</span><span class="kw">(</span><span class="vs">t, x</span><span class="kw">)</span><span class="dv">$</span><span class="vs">"</span>)</span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a>ax.set_zticks([])</span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a>u_plot <span class="op">=</span> u[<span class="dv">0</span>:<span class="op">-</span><span class="dv">1</span>:<span class="dv">10</span>, :]</span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(u_plot.shape[<span class="dv">0</span>]):</span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a>    ys <span class="op">=</span> j <span class="op">*</span> np.ones(u_plot.shape[<span class="dv">1</span>])</span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a>    ax.plot(x, ys, u_plot[j, :])</span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-51"><a href="#cb10-51" aria-hidden="true" tabindex="-1"></a><span class="co"># Image plot</span></span>
<span id="cb10-52"><a href="#cb10-52" aria-hidden="true" tabindex="-1"></a>plt.figure()</span>
<span id="cb10-53"><a href="#cb10-53" aria-hidden="true" tabindex="-1"></a>plt.imshow(np.flipud(u), aspect<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb10-54"><a href="#cb10-54" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="vs">r"</span><span class="dv">$</span><span class="vs">x</span><span class="dv">$</span><span class="vs">"</span>)</span>
<span id="cb10-55"><a href="#cb10-55" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="vs">r"</span><span class="dv">$</span><span class="vs">t </span><span class="ch">\t</span><span class="vs">o</span><span class="dv">$</span><span class="vs">"</span>)</span>
<span id="cb10-56"><a href="#cb10-56" aria-hidden="true" tabindex="-1"></a>plt.gca().axes.get_xaxis().set_ticks([])</span>
<span id="cb10-57"><a href="#cb10-57" aria-hidden="true" tabindex="-1"></a>plt.gca().axes.get_yaxis().set_ticks([])</span>
<span id="cb10-58"><a href="#cb10-58" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-fourier_fft_burger" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fourier_fft_burger-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-fourier_fft_burger" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="fig-fourier_fft_burger-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-fourier_fft_burger-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="fourier_files/figure-html/fig-fourier_fft_burger-output-1.svg" class="lightbox" data-gallery="fig-fourier_fft_burger" title="Figure&nbsp;8.6&nbsp;(a): Evolution of Burger’s equation in time."><img src="fourier_files/figure-html/fig-fourier_fft_burger-output-1.svg" class="img-fluid figure-img" data-ref-parent="fig-fourier_fft_burger"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-fourier_fft_burger-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Evolution of Burger’s equation in time.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="cell-output cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-fourier_fft_burger" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="fig-fourier_fft_burger-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-fourier_fft_burger-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="fourier_files/figure-html/fig-fourier_fft_burger-output-2.svg" class="lightbox" data-gallery="fig-fourier_fft_burger" title="Figure&nbsp;8.6&nbsp;(b): x-t diagram of Burger’s equation."><img src="fourier_files/figure-html/fig-fourier_fft_burger-output-2.svg" class="img-fluid figure-img" data-ref-parent="fig-fourier_fft_burger"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-fourier_fft_burger-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) x-t diagram of Burger’s equation.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fourier_fft_burger-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8.6: Time integration of the Burger’s equation
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
<p>The following example is taken from <span class="citation" data-cites="Meyberg1992-ws">(<a href="../references.html#ref-Meyberg1992-ws" role="doc-biblioref">Meyberg and Vachenauer 1992</a>)</span>.</p>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="exm-fourier-fft-gec" class="theorem example">
<p><span class="theorem-title"><strong>Example 8.7 (Ground Emitter Circuit)</strong></span> We can use FFT to compute some base properties of a ground emitter circuit <a href="#fig-fft-gec-1" class="quarto-xref">Figure&nbsp;<span>8.7</span></a> and show how the signal is propagated through this circuit <a href="#fig-fft-gec-2" class="quarto-xref">Figure&nbsp;<span>8.8</span></a>.</p>
<div id="fig-fft-gec-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fft-gec-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="../_assets/signal/electric_circuit.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-16" title="Figure&nbsp;8.7: Electric circuit"><img src="../_assets/signal/electric_circuit.svg" class="img-fluid figure-img" style="width:2.28in"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fft-gec-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8.7: Electric circuit
</figcaption>
</figure>
</div>
<div id="d56bae0d" class="cell" data-execution_count="13">
<details class="code-fold">
<summary>Show the raw data for the example</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>config InlineBackend.figure_formats <span class="op">=</span> [<span class="st">"svg"</span>]</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>frequ <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> np.pi <span class="op">*</span> <span class="dv">50</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> <span class="kw">lambda</span> t: <span class="fl">0.8</span> <span class="op">*</span> np.sin(t <span class="op">*</span> frequ)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>diod <span class="op">=</span> <span class="kw">lambda</span> t: (np.exp(<span class="fl">1.2</span> <span class="op">+</span> t) <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">2</span> <span class="op">*</span> np.pi <span class="op">/</span> frequ, <span class="dv">1024</span>, endpoint<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(np.<span class="bu">min</span>(f(t)) <span class="op">*</span> <span class="fl">1.3</span>, np.<span class="bu">max</span>(f(t)) <span class="op">*</span> <span class="fl">1.1</span>, <span class="dv">1024</span>)</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>ic <span class="op">=</span> <span class="kw">lambda</span> t: diod(f(t))</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>k <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">16</span>) <span class="op">*</span> <span class="dv">1</span> <span class="op">/</span> <span class="dv">16</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a><span class="co"># The provided figures where used to create the illustation</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">False</span>:</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>    plt.figure()</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>    plt.plot(f(t), t)</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>    plt.plot([np.<span class="bu">min</span>(t), np.<span class="bu">max</span>(t)], [<span class="dv">0</span>, <span class="dv">0</span>], <span class="st">"gray"</span>)</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>    plt.axis(<span class="st">"off"</span>)</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>    plt.savefig(<span class="st">"sin.svg"</span>, transparent<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>    plt.figure()</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>    plt.plot(x, diod(x))</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>    z <span class="op">=</span> np.array([<span class="dv">0</span>, np.<span class="bu">min</span>(f(t)), np.<span class="bu">max</span>(f(t))])</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>    plt.plot(z, diod(z), <span class="st">"bx"</span>)</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>    plt.axis(<span class="st">"off"</span>)</span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>    plt.xlim([<span class="op">-</span><span class="dv">2</span>, <span class="dv">5</span>])</span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>    plt.gcf().patch.set_visible(<span class="va">False</span>)</span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>    plt.savefig(<span class="st">"diode.svg"</span>, transparent<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>    plt.figure()</span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>    plt.plot(t, ic(t))</span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>    plt.plot(<span class="dv">2</span> <span class="op">*</span> np.pi <span class="op">*</span> k <span class="op">/</span> frequ, ic(<span class="dv">2</span> <span class="op">*</span> np.pi <span class="op">*</span> k <span class="op">/</span> frequ), <span class="st">"ro"</span>)</span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>    plt.axis(<span class="st">"off"</span>)</span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>    plt.savefig(<span class="st">"ic.svg"</span>, transparent<span class="op">=</span><span class="va">True</span>, bbox_inches<span class="op">=</span><span class="st">"tight"</span>)</span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> ic(k)</span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>yhat <span class="op">=</span> np.fft.fft(y)</span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Necessary correction factor for the FFT</span></span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a>factor <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> <span class="dv">16</span></span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a>yy <span class="op">=</span> factor <span class="op">*</span> yhat</span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a>ic_mean <span class="op">=</span> np.mean(ic(np.linspace(<span class="dv">0</span>, <span class="dv">1</span> <span class="op">/</span> <span class="dv">50</span>, <span class="dv">2</span><span class="op">**</span><span class="dv">20</span>)))</span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a>c0 <span class="op">=</span> yy[<span class="dv">0</span>].real</span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a>effective_value <span class="op">=</span> np.linalg.norm(yy[<span class="dv">1</span>:])</span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a>harmonic_distortion <span class="op">=</span> np.linalg.norm(yy[<span class="dv">3</span>:<span class="op">-</span><span class="dv">2</span>]) <span class="op">/</span> np.linalg.norm(yy[<span class="dv">1</span>:])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The transition of the transistor can be approximated by a diode and is illustrated in the <span class="math inline">\(u_{BE}\)</span> vs.&nbsp;<span class="math inline">\(i_C\)</span> diagram on the top left (orange signal in <a href="#fig-fft-gec-2" class="quarto-xref">Figure&nbsp;<span>8.8</span></a>). The exciting function <span class="math inline">\(u\)</span> on the bottom left is a normal sine wave with <span class="math inline">\(50\mathrm{Hz}\)</span>.</p>
<p>All together we get the equation <span class="math display">\[
i_c = \mathrm{e}^{1.2 + 0.8 \sin(2 \pi 50 t)} - 1
\]</span> for the current in <span class="math inline">\([\mathrm{mA}]\)</span> running through the transistor.</p>
<div id="fig-fft-gec-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fft-gec-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="../_assets/signal/signals.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-17" title="Figure&nbsp;8.8: Signal transition for the electric circuit shown above"><img src="../_assets/signal/signals.svg" class="img-fluid figure-img" style="width:4.88in"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fft-gec-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8.8: Signal transition for the electric circuit shown above
</figcaption>
</figure>
</div>
<p>We can see, that the signal is boosted depending on the characteristic curve of the diode, i.e.&nbsp;the positive part of the sine more than the negative part. If we compute the fast fourier transform, as illustrated with the red discretisation points of the curve on the right hand side, we can interpret the FFT coefficients <span class="math inline">\(c_i\)</span> as follows:</p>
<ol type="1">
<li><p>the direct current component:</p>
<p><span class="math display">\[
c_0 = 2.873
\]</span></p></li>
<li><p>the effective value from Parseval’s Theorem:</p>
<p><span class="math display">\[
\overline{i_c} = \sqrt{\sum_{i=0}^{15} |c_i|^2}= 2.071
\]</span></p></li>
<li><p>the total harmonic distortion (how the signal is deformed):</p>
<p><span class="math display">\[
THD = \frac{\sqrt{\sum_{i=2}^{14} |c_i|^2}}{\sqrt{\sum_{i=1}^{15} |c_i|^2}}=0.193
\]</span></p></li>
</ol>
</div>
</div>
</div>
</div>
<p>This concludes our example with the FFT.</p>
</section>
</section>
<section id="gabor-transform" class="level2" data-number="8.5">
<h2 data-number="8.5" class="anchored" data-anchor-id="gabor-transform"><span class="header-section-number">8.5</span> Gabor Transform</h2>
<p>The Fourier transform is computed as soon as all the values of a signal are sampled. It provides spectral information over the entire signal and not when in time certain frequencies occur, i.e.&nbsp;no temporal information. The Fourier transform can only characterize periodic and stationary signals. The time component is <em>used</em> during the integration and no longer present in the transformed signal.</p>
<p>If both is needed in order to generate a spectrogram (plot frequency versus time), the Gabor transform brings remedy. Technically it is the Fourier transform of the signal masked by a sliding window <span class="math display">\[
\mathcal{G}\{f\}(t, \omega) = G_f(t, \omega) = \int_{-\infty}^\infty f(\tau) \mathrm{e}^{-\mathrm{i}\omega\tau}\overline{g}(\tau - t)\, \mathrm{d}\tau.
\]</span> For the so called <em>kernel</em> <span class="math inline">\(g(t)\)</span> a Gaussian bell curve is often used <span class="math display">\[
g(t - \tau) =  \mathrm{e}^{-\tfrac{(t-\tau)^2}{a^2}}.
\]</span></p>
<div id="cell-fig-fourier_gabor" class="cell" data-execution_count="17">
<details class="code-fold">
<summary>Show the code for the figure</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>config InlineBackend.figure_formats <span class="op">=</span> [<span class="st">"svg"</span>]</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">6020</span>)</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameters</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> <span class="dv">1024</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>a, b <span class="op">=</span> <span class="dv">0</span>, <span class="dv">1</span> <span class="op">/</span> <span class="dv">4</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> np.linspace(a, b, N, endpoint<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>dt <span class="op">=</span> t[<span class="dv">1</span>] <span class="op">-</span> t[<span class="dv">0</span>]</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>f1 <span class="op">=</span> <span class="dv">50</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>f2 <span class="op">=</span> <span class="dv">120</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>fun <span class="op">=</span> <span class="kw">lambda</span> t: np.sin(<span class="dv">2</span> <span class="op">*</span> np.pi <span class="op">*</span> f1 <span class="op">*</span> t) <span class="op">+</span> np.sin(<span class="dv">2</span> <span class="op">*</span> np.pi <span class="op">*</span> f2 <span class="op">*</span> t)</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>gauss <span class="op">=</span> <span class="kw">lambda</span> x, a: np.exp(<span class="op">-</span>np.<span class="bu">pow</span>(x, <span class="dv">2</span>) <span class="op">/</span> a<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>f_clean <span class="op">=</span> fun(t) <span class="op">+</span> np.random.randn(<span class="bu">len</span>(t))</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>gauss <span class="op">=</span> gauss(t <span class="op">-</span> <span class="fl">0.125</span>, <span class="fl">0.025</span>) <span class="op">*</span> <span class="fl">4.8</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Figures</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>plt.figure(<span class="dv">0</span>)</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>plt.plot(t, f_clean, label<span class="op">=</span><span class="st">"Signal"</span>)</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>plt.plot(t, gauss, label<span class="op">=</span><span class="vs">r"</span><span class="dv">$</span><span class="vs">g</span><span class="kw">(</span><span class="vs">t-</span><span class="ch">\t</span><span class="vs">au</span><span class="kw">)</span><span class="dv">$</span><span class="vs">"</span>)</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.xlabel("Time [s]")</span></span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.ylabel(r"$f$")</span></span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>plt.xticks([<span class="fl">0.1</span>, <span class="fl">0.125</span>, <span class="fl">0.15</span>], [<span class="vs">r"</span><span class="dv">$</span><span class="ch">\t</span><span class="vs">au - a</span><span class="dv">$</span><span class="vs">"</span>, <span class="vs">r"</span><span class="dv">$</span><span class="ch">\t</span><span class="vs">au</span><span class="dv">$</span><span class="vs">"</span>, <span class="vs">r"</span><span class="dv">$</span><span class="ch">\t</span><span class="vs">au </span><span class="op">+</span><span class="vs"> a</span><span class="dv">$</span><span class="vs">"</span>])</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>plt.xlim(t[<span class="dv">0</span>], t[<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>plt.ylim(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>)</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>plt.yticks([])</span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>plt.legend(loc<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>plt.gca().set_aspect(<span class="fl">5e-3</span>)</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-fourier_gabor" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fourier_gabor-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="fourier_files/figure-html/fig-fourier_gabor-output-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-18" title="Figure&nbsp;8.9: Signal with Gaussian kernel"><img src="fourier_files/figure-html/fig-fourier_gabor-output-1.svg" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fourier_gabor-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8.9: Signal with Gaussian kernel
</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#fig-fourier_gabor" class="quarto-xref">Figure&nbsp;<span>8.9</span></a> illustrates the sliding time window with the spread as <span class="math inline">\(a\)</span> and the center <span class="math inline">\(\tau\)</span>. The inverse is given as <span class="math display">\[
f(t) = \mathcal{G}^{-1}\{G_f(t, \omega)\} = \frac{1}{2 \pi \|g\|^2} = \int_{-\infty}^\infty\int_{-\infty}^\infty G_f(\tau, \omega) \mathrm{e}^{\mathrm{i}\omega\tau}\overline{g}(t - \tau)\, \mathrm{d}\omega\, \mathrm{d}t.
\]</span></p>
<p>As with the Fourier transform the application of the Gabor transform is usually done in its discrete form.</p>
<div class="callout callout-style-simple callout-none no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="def-fourier-dgt" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 8.8 (Discrete Gabor Transform)</strong></span> For discrete time <span class="math inline">\(\tau = k \Delta t\)</span> and frequencies <span class="math inline">\(\nu = j \Delta \omega\)</span> the discretized kernel function has the form <span class="math display">\[
g_{j,k} = \mathrm{e}^{{\mathrm{i}2 \pi j\Delta\omega t}} g(t- k\Delta t)
\]</span> and the discrete Gabor transform <span class="math display">\[
\mathcal{G}\{f\}_{j,k} = \langle f, g_{j,k} \rangle = \int_{-\infty}^\infty f(\tau)\overline{g}_{j,k}(\tau)\, \mathrm{d}\tau.
\]</span></p>
</div>
</div>
</div>
</div>
<p>The following example is taken from <span class="citation" data-cites="Brunton2022">(<a href="../references.html#ref-Brunton2022" role="doc-biblioref">Brunton and Kutz 2022, 77–78</a>)</span>.</p>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="exm-fourier-dgt-chirp" class="theorem example">
<p><span class="theorem-title"><strong>Example 8.8 (Gabor transform for a quadratic chirp)</strong></span> As example we use an oscillating cosine function where the frequency of the oscillation increases as a quadratic function in time: <span class="math display">\[
f(t) = \cos(2\pi\, t\, h(t)), \quad \text{with}\quad h(t) = h_0 + (h_1 - h_0)\frac{t}{3 t_1^2},
\]</span> where the frequency shifts from <span class="math inline">\(h_0\)</span> to <span class="math inline">\(h_1\)</span> between <span class="math inline">\(t=0\)</span> and <span class="math inline">\(t=t_1\)</span>.</p>
<p>The majority of the following code is from <span class="citation" data-cites="Brunton2022">(<a href="../references.html#ref-Brunton2022" role="doc-biblioref">Brunton and Kutz 2022</a>, Code 2.9)</span>.</p>
<details class="code-fold">
<summary>Show the code for the figure</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.integrate <span class="im">import</span> odeint</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>config InlineBackend.figure_formats <span class="op">=</span> [<span class="st">"svg"</span>]</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> <span class="dv">2048</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>a, b <span class="op">=</span> <span class="dv">0</span>, <span class="dv">2</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> np.linspace(a, b, N, endpoint<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>dt <span class="op">=</span> t[<span class="dv">1</span>] <span class="op">-</span> t[<span class="dv">0</span>]</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>h0 <span class="op">=</span> <span class="dv">50</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>h1 <span class="op">=</span> <span class="dv">250</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>t1 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.cos(<span class="dv">2</span> <span class="op">*</span> np.pi <span class="op">*</span> t <span class="op">*</span> (h0 <span class="op">+</span> (h1 <span class="op">-</span> h0) <span class="op">*</span> np.power(t, <span class="dv">2</span>) <span class="op">/</span> (<span class="dv">3</span> <span class="op">*</span> t1<span class="op">**</span><span class="dv">2</span>)))</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>plt.figure(<span class="dv">0</span>)</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> <span class="bu">len</span>(x)</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>freq <span class="op">=</span> (<span class="dv">1</span> <span class="op">/</span> (dt <span class="op">*</span> N)) <span class="op">*</span> np.arange(N)</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>PSD_noise <span class="op">=</span> np.<span class="bu">abs</span>(np.fft.fft(x)) <span class="op">**</span> <span class="dv">2</span> <span class="op">/</span> N</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>plt.plot(freq[: N <span class="op">//</span> <span class="dv">2</span>], PSD_noise[: N <span class="op">//</span> <span class="dv">2</span>])</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Frequency [Hz]"</span>)</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>plt.gca().set_aspect(<span class="dv">10</span>)</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>plt.figure(<span class="dv">1</span>)</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>plt.specgram(x, NFFT<span class="op">=</span><span class="dv">128</span>, Fs<span class="op">=</span><span class="dv">1</span> <span class="op">/</span> dt, noverlap<span class="op">=</span><span class="dv">120</span>, cmap<span class="op">=</span><span class="st">"jet"</span>)</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>plt.colorbar()</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Time [s]"</span>)</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Frequency [Hz]"</span>)</span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-fourier_dgt_chirp" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fourier_dgt_chirp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-fourier_dgt_chirp" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="fig-fourier_dgt_chirp-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-fourier_dgt_chirp-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="fourier_files/figure-html/fig-fourier_dgt_chirp-output-1.svg" class="lightbox" data-gallery="fig-fourier_dgt_chirp" title="Figure&nbsp;8.10&nbsp;(a): Power spectral density of the signal."><img src="fourier_files/figure-html/fig-fourier_dgt_chirp-output-1.svg" class="img-fluid figure-img" data-ref-parent="fig-fourier_dgt_chirp"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-fourier_dgt_chirp-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Power spectral density of the signal.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="cell-output cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-fourier_dgt_chirp" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="fig-fourier_dgt_chirp-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-fourier_dgt_chirp-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="fourier_files/figure-html/fig-fourier_dgt_chirp-output-2.svg" class="lightbox" data-gallery="fig-fourier_dgt_chirp" title="Figure&nbsp;8.10&nbsp;(b): Spectrogram."><img src="fourier_files/figure-html/fig-fourier_dgt_chirp-output-2.svg" class="img-fluid figure-img" data-ref-parent="fig-fourier_dgt_chirp"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-fourier_dgt_chirp-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Spectrogram.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fourier_dgt_chirp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8.10: Quadratic chirp signal
</figcaption>
</figure>
</div>
<p>We can see a clear peak at 50Hz but no information of time is given, where else in the spectrogram we see how the frequency progresses in time.</p>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>For the analysis of time-frequency we see Heisenberg’s uncertainty principle at work. We cannot attain high resolution simultaneously in both time and frequency domain. In the time domain we have perfect resolution but no information about the frequencies, in the Fourier domain the time information is not present.</p>
<p>The spectrogram resolves both but with reduced resolution. This effect manifests differently at different locations of the chirp signal. At the left where the frequency is almost constant, the band becomes narrower, whereas at the right it becomes wider due to the increased blur in horizontal direction. The product of the uncertainties of these quantities has a minimal value. In this context time and frequency domain respectively represent the extremes.</p>
</div>
</div>
<p>The Fourier transform always assumes a harmonic nature in the signal it is applied to. Therefore, it is best suited for e.g.&nbsp;music, rotating machines or vibrations. For other signals, especially with discontinuous parts (Gibbs phenomenon) there are more adequate bases functions. We look at these in the next section <a href="wavelet.html" class="quarto-xref"><span>Chapter 10</span></a> but first we look at the Laplace transform <a href="laplace.html" class="quarto-xref"><span>Chapter 9</span></a>.</p>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-Brunton2022" class="csl-entry" role="listitem">
Brunton, Steven L., and J. Nathan Kutz. 2022. <em>Data-Driven Science and Engineering - Machine Learning, Dynamical Systems, and Control</em>. 2nd ed. Cambridge: Cambridge University Press.
</div>
<div id="ref-Cooley1965" class="csl-entry" role="listitem">
Cooley, James W., and John W. Tukey. 1965. <span>“An Algorithm for the Machine Calculation of Complex Fourier Series.”</span> <em>Mathematics of Computation</em> 19 (90): 297–301. <a href="https://doi.org/10.1090/s0025-5718-1965-0178586-1">https://doi.org/10.1090/s0025-5718-1965-0178586-1</a>.
</div>
<div id="ref-Gauss" class="csl-entry" role="listitem">
Gauß, Carl Friedrich. 1866. <span>“Theoria Interpolationis Methodo Nova Tractata.”</span><a href=" http://resolver.sub.uni-goettingen.de/purl?DE-611-HS-3373323 ">http://resolver.sub.uni-goettingen.de/purl?DE-611-HS-3373323 </a>.
</div>
<div id="ref-Meyberg1992-ws" class="csl-entry" role="listitem">
Meyberg, Kurt, and Peter Vachenauer. 1992. <em>H<span>ö</span>here Mathematik 2</em>. Springer-Lehrbuch. New York, NY: Springer.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/kandolfp\.github\.io\/MECH-M-DUAL-1-DBM\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../signal/index.html" class="pagination-link" aria-label="Signal Processing">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Signal Processing</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../signal/laplace.html" class="pagination-link" aria-label="Laplace Transform">
        <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Laplace Transform</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Basics of Data Science WS 2025/26 (MECH-M-DUAL-1-GDM)</p>
</div>   
    <div class="nav-footer-center">
<p><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> Peter Kandolf</p>
<div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/kandolfp/MECH-M-DUAL-1-DBM/edit/main/signal/fourier.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/kandolfp/MECH-M-DUAL-1-DBM/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>This book was built with <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>