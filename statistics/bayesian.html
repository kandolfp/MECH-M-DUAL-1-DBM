<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.37">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>14&nbsp; Bayesian Statistics – Basics of Data Science</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../statistics/kalman.html" rel="next">
<link href="../statistics/index.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-29e2c20b02301cfff04dc8050bf30c7e.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark-43df0d6f53b733b42d37fa7808e17715.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-bbb4ab346ed2948d3a2a60dc9ba93ba5.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark-54b5e27635ce7b559bdb01e89402beb6.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script src="../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../statistics/index.html">Statistics</a></li><li class="breadcrumb-item"><a href="../statistics/bayesian.html"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Bayesian Statistics</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Basics of Data Science</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/kandolfp/MECH-M-DUAL-1-DBM/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../basics/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Basics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basics/linearalgebra.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Linear Algebra</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basics/sets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data sets</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../matrixdc/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Matrix decompositions</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../matrixdc/eigen.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Eigendecomposition</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../matrixdc/svd.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Singular Value Decomposition</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Regression analysis</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../regression/linear.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Linear Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../regression/nonlinear.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Non-linear Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../regression/optimizers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Optimizers</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../signal/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Signal Processing</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../signal/fourier.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Fourier Transform</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../signal/laplace.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Laplace Transform</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../signal/wavelet.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Wavelet transform</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../signal/twodim.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Two-Dimensional Transform</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../sensing/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Sparsity and compression</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../sensing/sparsity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Sparsity and Compression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../sensing/compsensing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Compressed Sensing</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../statistics/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../statistics/bayesian.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Bayesian Statistics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../statistics/kalman.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Kalman Filter</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Summary</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#random-variable" id="toc-random-variable" class="nav-link active" data-scroll-target="#random-variable"><span class="header-section-number">14.1</span> Random variable</a>
  <ul class="collapse">
  <li><a href="#discrete-random-variables" id="toc-discrete-random-variables" class="nav-link" data-scroll-target="#discrete-random-variables"><span class="header-section-number">14.1.1</span> Discrete random variables</a></li>
  <li><a href="#continuous-random-variable" id="toc-continuous-random-variable" class="nav-link" data-scroll-target="#continuous-random-variable"><span class="header-section-number">14.1.2</span> Continuous random variable</a></li>
  </ul></li>
  <li><a href="#probability-distributions" id="toc-probability-distributions" class="nav-link" data-scroll-target="#probability-distributions"><span class="header-section-number">14.2</span> Probability distributions</a></li>
  <li><a href="#bayes-theorem-in-action" id="toc-bayes-theorem-in-action" class="nav-link" data-scroll-target="#bayes-theorem-in-action"><span class="header-section-number">14.3</span> Bayes’ theorem in action</a>
  <ul class="collapse">
  <li><a href="#election-prediction-as-instructive-example" id="toc-election-prediction-as-instructive-example" class="nav-link" data-scroll-target="#election-prediction-as-instructive-example"><span class="header-section-number">14.3.1</span> Election prediction as instructive example</a></li>
  <li><a href="#material-properties" id="toc-material-properties" class="nav-link" data-scroll-target="#material-properties"><span class="header-section-number">14.3.2</span> Material properties</a></li>
  </ul></li>
  <li><a href="#conjugate-priors" id="toc-conjugate-priors" class="nav-link" data-scroll-target="#conjugate-priors"><span class="header-section-number">14.4</span> Conjugate priors</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/kandolfp/MECH-M-DUAL-1-DBM/edit/main/statistics/bayesian.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/kandolfp/MECH-M-DUAL-1-DBM/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../statistics/index.html">Statistics</a></li><li class="breadcrumb-item"><a href="../statistics/bayesian.html"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Bayesian Statistics</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-statistic-bayesian" class="quarto-section-identifier"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Bayesian Statistics</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>In the middle of the eighteenth century Joshua Bayes, a Presbyterian minister, set the ground work and as it so often happens was first not acknowledged by his peers.</p>
<p>The basic rule is often illustrated via a Venn diagram for sets.</p>
<div id="fig-statistics-venn" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-statistics-venn-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="../_assets/statistics/vann.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Figure&nbsp;14.1: Venn diagram illustrating the principal of joint probabilities."><img src="../_assets/statistics/vann.svg" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-statistics-venn-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;14.1: Venn diagram illustrating the principal of joint probabilities.
</figcaption>
</figure>
</div>
<p>Translated into a statistic problem this becomes: What is the probability, that a number is both, in set <span class="math inline">\(A\)</span> and set <span class="math inline">\(B\)</span>.</p>
<p>Before we can write this down proper we need to introduce some notation. With <span class="math inline">\(P(A)\)</span> we denote the probability of the event <span class="math inline">\(A\)</span> and <span class="math inline">\(P(A, B, \ldots)\)</span> the probability of all events listed combined. Furthermore we call <span class="math inline">\(P(\neg A)\)</span> the probability of <em>not</em> <span class="math inline">\(A\)</span>, i.e.&nbsp;<span class="math inline">\(P(\neg A) = 1 - P(A)\)</span>.</p>
<div class="callout callout-style-simple callout-none no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="def-statistics-independent" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 14.1 (Independent events - unconditional probability)</strong></span> We call two events <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> independent if the fact that we know <span class="math inline">\(A\)</span> happened does not give us any insight the probability that <span class="math inline">\(B\)</span> happens or vice versa.</p>
<p>In this case the probability of both events happening is <span class="math display">\[
P(A, B) = P(A) P(B).
\]</span></p>
<p>An example is the classic coin toss. After throwing the first coin that lands on heads we have no information what the second toss will likely be.</p>
<p>So if we say <span class="math inline">\(A\)</span> represents <em>first flip heads</em>, <span class="math inline">\(B\)</span> <em>second flip heads</em> we get <span class="math display">\[
P(A, B) = P(A) P(B) = \frac12 \frac12 = \frac14,
\]</span> or if <span class="math inline">\(B\)</span> represents <em>both flips tail</em> we get: <span class="math display">\[
P(A, B) = P(A) P(B) = \frac12 0 = 0.
\]</span></p>
</div>
</div>
</div>
</div>
<p>Now what happens when the two events are not independent.</p>
<div class="callout callout-style-simple callout-none no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="def-statistics-dependent" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 14.2 (Dependent events - conditional probability)</strong></span> If two events <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are not independent and the probability of event <span class="math inline">\(B\)</span> is not zero, i.e.&nbsp;<span class="math inline">\(P(B)\neq 0\)</span> we define the conditional probability of <span class="math inline">\(A\)</span> under the condition <span class="math inline">\(B\)</span> as <span class="math inline">\(P(A | B)\)</span> and we get the relation <span class="math display">\[
P(A | B) = \frac{P(A, B)}{P(B)}.
\]</span></p>
</div>
</div>
</div>
</div>
<p>Therefore, if we return to our Venn diagram in <a href="#fig-statistics-venn" class="quarto-xref">Figure&nbsp;<span>14.1</span></a> we can see this relation played out. As <span class="math inline">\(P(A|B)\)</span> can be understood as the fraction of probability <span class="math inline">\(B\)</span> that intersects with <span class="math inline">\(A\)</span>.</p>
<div class="callout callout-style-simple callout-none no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="def-statistics-ljp" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 14.3 (Law of joint probabilities)</strong></span> For two events <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> the following relation <span class="math display">\[
P(A, B) = P(B|A) P(A) = P(A|B) P(B)
\]</span> is called the <strong>law of joint probabilities</strong>.</p>
</div>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-none no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="def-statistics-bayesianth" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 14.4 (Bayes’ theorem)</strong></span> For two events <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> as well as there dependent probabilities the following relation is called Bayes’ theorem <span class="math display">\[
P(A|B) = \frac{P(B|A) P(A)}{P(B)}.
\]</span></p>
<p>The term <span class="math inline">\(P(A|B)\)</span> is usually called the <strong>posterior probability density</strong> (posterior for short), <span class="math inline">\(P(A)\)</span> the <strong>prior</strong>, <span class="math inline">\(P(B|A)\)</span> the <strong>likelihood</strong>, and finally the term <span class="math inline">\(P(B)\)</span> the <strong>denominator</strong>.</p>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>We have some further properties that follow from the above definitions for two events <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>.</p>
<p>If they are independent we get <span class="math display">\[
P(A|B) = P(A).
\]</span></p>
<p>Furthermore, if <span class="math inline">\(\neg B\)</span> denotes the negative of <span class="math inline">\(B\)</span> we have <span class="math display">\[
P(A) = P(A, B) + P(A, \neg B)
\]</span> and therefore we get <span class="math display">\[
P(A|B) = \frac{P(B|A) P(A)}{P(B|A)P(A) + P(B|\neg A)P(\neg A)}
\]</span></p>
</div>
</div>
<p>Let us look at this with an example.</p>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="exm-statistics-cancerscreeing" class="theorem example">
<p><span class="theorem-title"><strong>Example 14.1 (Cancer Screening)</strong></span> Let us assume we look at a medical procedure that tests for something like prostate or breast cancer.</p>
<p>This test for <span class="math inline">\(cancer\)</span> is quite reliable with a true positive rate of <span class="math inline">\(80\%\)</span> and a true negative rate with <span class="math inline">\(90\%\)</span>. This translates into the probabilities <span class="math display">\[
\begin{aligned}
P(+ | cancer) = 0.8,\\
P(+ | \neg cancer) = 0.1.
\end{aligned}
\]</span> furthermore we assume that only <span class="math inline">\(1\%\)</span> of all the people taking the exam actually have cancer, i.e. <span class="math display">\[
P(cancer) = 0.01.
\]</span></p>
<p>From Beyes’ theorem we can compute the probability (or likelihood) to have cancer when receiving a positive test result as <span class="math display">\[
P(cancer | +) = \frac{P(+ | cancer) P(cancer)}{P(+)}
\]</span> The part we do not know in this equation is <span class="math inline">\(P(+)\)</span> but we can compute this with <a href="#def-statistics-ljp" class="quarto-xref">Definition&nbsp;<span>14.3</span></a> as <span class="math display">\[
\begin{aligned}
P(+) &amp;= P(+, cancer) + P(+, \neg cancer) \\
     &amp;= P(+| cancer)P(cancer) + P(+| \neg cancer) P(\neg cancer)\\
     &amp;= 0.8 \cdot 0.01 + 0.1 \cdot 0.99 = 0.107.
\end{aligned}
\]</span></p>
<p>Overall, this allow us to compute <span class="math display">\[
P(cancer | +) = \frac{P(+ | cancer) P(cancer)}{P(+)} = \frac{0.8 \cdot 0.01}{0.107} = 0.07477.
\]</span></p>
<p><span class="citation" data-cites="Lambert2018-ll">(Compare <a href="../references.html#ref-Lambert2018-ll" role="doc-biblioref">Lambert 2018, sec. 3.6.2</a>)</span></p>
</div>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-caution no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="exr-statistics-bayes" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 14.1 (Bayes’ theorem)</strong></span> &nbsp;</p>
<ol type="1">
<li>A person is known to lie one third the time. This person throws a die and reports it is a 4 (four).<br>
<br>
What is the probability that it is actually a four?<br>
</li>
<li>There are 3 urns containing 3 white and 2 black, 2 white and 3 black, as well as 4 white and 1 black ball respectively. Each urn can be chosen with equal probability.<br>
<br>
What is the likelihood that a white ball is drawn?</li>
</ol>
</div>
</div>
</div>
</div>
<section id="random-variable" class="level2" data-number="14.1">
<h2 data-number="14.1" class="anchored" data-anchor-id="random-variable"><span class="header-section-number">14.1</span> Random variable</h2>
<p>A random variable <span class="math inline">\(X\)</span> (often also called random quantity or stochastic variable) is a variable that is dependent on <em>random events</em> and is a function defined on a probability space <span class="math inline">\((\Omega, \mathcal{F}, P)\)</span>. <span class="math inline">\(\Omega\)</span> is called the sample space of all possible outcomes, <span class="math inline">\(\mathcal{F}\)</span> the event space (a set of outcomes in the sample space), and <span class="math inline">\(P\)</span> is the probability function which assigns each event in the event space a probability as a number between <span class="math inline">\(0\)</span> and <span class="math inline">\(1\)</span>.</p>
<p>A very simple random variable is the one describing a coin toss. It is one for heads and zero for tails. To increase the complexity we can search for a random variable that tells us how often tails was the result for <span class="math inline">\(n\)</span> coin tosses.</p>
<p>To get a better idea what <span class="math inline">\((\Omega, \mathcal{F}, P)\)</span> and <span class="math inline">\(X\)</span> is we should ask a the following question: <em>How likely is the value of <span class="math inline">\(X=2\)</span>?</em></p>
<p>To answer this question we need to find the probability of the event ${,:, X() = 2} that can be expressed via <span class="math inline">\(P\)</span> as <span class="math inline">\(P(X=2)=p_X(2)\)</span>.</p>
<p>If we record all this probabilities of outcomes of <span class="math inline">\(X\)</span> results in the <strong>probability distribution</strong> of <span class="math inline">\(X\)</span>. If this probability distribution is real valued we get the <strong>cumulative distribution function</strong> (CDF) <span class="math display">\[
F_X(x) = P(X\leq x).
\]</span></p>
<section id="discrete-random-variables" class="level3" data-number="14.1.1">
<h3 data-number="14.1.1" class="anchored" data-anchor-id="discrete-random-variables"><span class="header-section-number">14.1.1</span> Discrete random variables</h3>
<p>We have already seen a discrete random variable as <em>the number of heads for <span class="math inline">\(n\)</span> coin tosses</em>, other possibilities are <em>the number of children for a person</em>.</p>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="exm-statistics-cointoss" class="theorem example">
<p><span class="theorem-title"><strong>Example 14.2 (Coin toss)</strong></span> For the coin toss we have <span class="math inline">\(\Omega=\{heads, tails\}\)</span> and <span class="math display">\[
X(\omega) =
\begin{cases}
1, \quad \text{if}\, \omega = heads,\\
0, \quad \text{if}\, \omega = tails.
\end{cases}
\]</span> for a <em>fair coin</em> the function <span class="math display">\[
F_X(x) =
\begin{cases}
\frac12, \quad \text{if}\, y = 1,\\
\frac12, \quad \text{if}\, y = 0.
\end{cases}
\]</span></p>
<p>Of course this does not mean we will get exactly <span class="math inline">\(\frac12\)</span> for <span class="math inline">\(n\)</span> tosses but with the rule of large numbers we see that it will end up there for a lot of flips</p>
<div id="cell-fig-statistics-cointossln" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Show the code for the figure</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>config InlineBackend.figure_formats <span class="op">=</span> [<span class="st">"svg"</span>]</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">6020</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scipy.special</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">1_001</span>, <span class="dv">2</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> []</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> n <span class="kw">in</span> x:</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    y.append(np.<span class="bu">sum</span>(np.random.rand(n) <span class="op">&lt;</span> <span class="fl">0.5</span>) <span class="op">/</span> n)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>plt.plot(x, y)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>plt.plot([<span class="dv">0</span>, <span class="bu">max</span>(x)], [<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>,  <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>])</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>plt.gca().set_aspect(<span class="dv">1000</span> <span class="op">/</span> (<span class="dv">3</span>))</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-statistics-cointossln" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-statistics-cointossln-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="bayesian_files/figure-html/fig-statistics-cointossln-output-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Figure&nbsp;14.2: Rule of large numbers for coin toss, coin toss simulated by a random numbers smaller or grater than 0.5."><img src="bayesian_files/figure-html/fig-statistics-cointossln-output-1.svg" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-statistics-cointossln-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;14.2: Rule of large numbers for coin toss, coin toss simulated by a random numbers smaller or grater than 0.5.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="continuous-random-variable" class="level3" data-number="14.1.2">
<h3 data-number="14.1.2" class="anchored" data-anchor-id="continuous-random-variable"><span class="header-section-number">14.1.2</span> Continuous random variable</h3>
<p>If the cumulative distribution function is continuous everywhere we get have a continuous random variable. For such variables it makes more sense to not look for an exact equality with a number but rather, what is the probability that <span class="math inline">\(X\)</span> lies between <span class="math inline">\([a, b]\)</span>.</p>
<p>Example could be the height of a person (if we can measure continuously). In this example it the probability that a person is exactly <span class="math inline">\(185m\)</span> is zero but the question if somebodies hight is in <span class="math inline">\([180, 190)\)</span> makes sense.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>We introduced the Laplace transform in <a href="../signal/laplace.html" class="quarto-xref"><span>Chapter 9</span></a>. It finds an application in probability theory where the Laplace transform of a random variable <span class="math inline">\(X\)</span> is defined as the expected value of <span class="math inline">\(X\)</span> with probability density function <span class="math inline">\(f\)</span>, i.e.</p>
<p><span class="math display">\[
\mathcal{L}\{f\}(s) = \mathrm{E}\left[\mathrm{e}^{- s X}\right].
\]</span></p>
<p>Furthermore, we can recover the copulative distribution function of a continuous random variable <span class="math inline">\(X\)</span> as <span class="math display">\[
F_X(x) = \mathcal{L}^{-1}\left\{ \frac{1}{s} \mathrm{E}\left[\mathrm{e}^{- s X}\right]\right\}(x) = \mathcal{L}^{-1}\left\{ \frac{1}{s} \mathcal{L}\{f\}(s)\right\}(x).
\]</span></p>
</div>
</div>
</section>
</section>
<section id="probability-distributions" class="level2" data-number="14.2">
<h2 data-number="14.2" class="anchored" data-anchor-id="probability-distributions"><span class="header-section-number">14.2</span> Probability distributions</h2>
<p>It is instructive to look at some of the most common probability distributions so that we know what we can describe by these them.</p>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="exm-statistics-binomial_dist" class="theorem example">
<p><span class="theorem-title"><strong>Example 14.3 (Binomial distribution)</strong></span> The binomial distribution is a discrete probability function with parameters <span class="math inline">\(n\)</span> and <span class="math inline">\(p\)</span>. It describes the number of successes in a sequence of <span class="math inline">\(n\)</span> independent experiments, where <span class="math inline">\(p\)</span> describes the probability of the experiment being a success.</p>
<p>The probability density function is <span class="math display">\[
f(x) = \left(\begin{array}{c} n\\ x\end{array}\right) p^k (1-p)^{n-k},
\]</span> with <span class="math display">\[
\left(\begin{array}{c} n\\ x\end{array}\right) = \frac{n!}{k!(n-k)!}.
\]</span> It measures the probability that we get exactly <span class="math inline">\(x\)</span> successes in <span class="math inline">\(n\)</span> independent trials.</p>
<p>The corresponding CDF is <span class="math display">\[
F(x) = \sum_{i=0}^{\lfloor x \rfloor}\left(\begin{array}{c} n\\ i\end{array}\right) p^i(1-p)^{n-i}.
\]</span></p>
<details class="code-fold">
<summary>Show the code for the figure</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>config InlineBackend.figure_formats <span class="op">=</span> [<span class="st">"svg"</span>]</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> <span class="kw">lambda</span> n, p, x: np.vectorize(<span class="kw">lambda</span> x: math.comb(n, x))(x) <span class="op">*</span> <span class="op">\</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>                    np.<span class="bu">pow</span>(p, x) <span class="op">*</span> np.<span class="bu">pow</span>(<span class="dv">1</span> <span class="op">-</span> p, n <span class="op">-</span> x)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>helper <span class="op">=</span> <span class="kw">lambda</span> n, p, x: np.<span class="bu">sum</span>(f(n, p, np.arange(<span class="dv">0</span>, x <span class="op">+</span> <span class="dv">1</span>)))</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>cfd <span class="op">=</span> <span class="kw">lambda</span> n, p, x: np.vectorize(<span class="kw">lambda</span> x: helper(n, p, x))(x)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">40</span>)</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>plt.figure()</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>plt.plot(x, f(<span class="dv">20</span>, <span class="fl">0.5</span>, x), <span class="st">"o"</span>, label<span class="op">=</span><span class="vs">r"$n=20, p=\frac</span><span class="sc">{1}{2}</span><span class="vs">$"</span>)</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>plt.plot(x, f(<span class="dv">20</span>, <span class="fl">0.7</span>, x), <span class="st">"x"</span>, label<span class="op">=</span><span class="vs">r"$n=20, p=\frac</span><span class="sc">{7}{10}</span><span class="vs">$"</span>)</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>plt.plot(x, f(<span class="dv">40</span>, <span class="fl">0.5</span>, x), <span class="st">"d"</span>, label<span class="op">=</span><span class="vs">r"$n=40, p=\frac</span><span class="sc">{1}{2}</span><span class="vs">$"</span>)</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>plt.gca().set_aspect(<span class="dv">40</span><span class="op">/</span>(<span class="dv">3</span> <span class="op">*</span> <span class="fl">0.2</span>))</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>plt.figure()</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>plt.plot(x, cfd(<span class="dv">20</span>, <span class="fl">0.5</span>, x), <span class="st">"o"</span>, label<span class="op">=</span><span class="vs">r"$n=20, p=\frac</span><span class="sc">{1}{2}</span><span class="vs">$"</span>)</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>plt.plot(x, cfd(<span class="dv">20</span>, <span class="fl">0.7</span>, x), <span class="st">"x"</span>, label<span class="op">=</span><span class="vs">r"$n=20, p=\frac</span><span class="sc">{7}{10}</span><span class="vs">$"</span>)</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>plt.plot(x, cfd(<span class="dv">40</span>, <span class="fl">0.5</span>, x), <span class="st">"d"</span>, label<span class="op">=</span><span class="vs">r"$n=40, p=\frac</span><span class="sc">{1}{2}</span><span class="vs">$"</span>)</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>plt.gca().set_aspect(<span class="dv">40</span><span class="op">/</span>(<span class="dv">3</span> <span class="op">*</span> <span class="dv">1</span>))</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-statistics-binomial" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-statistics-binomial-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-statistics-binomial" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="fig-statistics-binomial-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-statistics-binomial-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="bayesian_files/figure-html/fig-statistics-binomial-output-1.svg" class="lightbox" data-gallery="fig-statistics-binomial" title="Figure&nbsp;14.3&nbsp;(a): Probability density function."><img src="bayesian_files/figure-html/fig-statistics-binomial-output-1.svg" class="img-fluid figure-img" data-ref-parent="fig-statistics-binomial"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-statistics-binomial-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Probability density function.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="cell-output cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-statistics-binomial" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="fig-statistics-binomial-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-statistics-binomial-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="bayesian_files/figure-html/fig-statistics-binomial-output-2.svg" class="lightbox" data-gallery="fig-statistics-binomial" title="Figure&nbsp;14.3&nbsp;(b): Cumulative distribution function."><img src="bayesian_files/figure-html/fig-statistics-binomial-output-2.svg" class="img-fluid figure-img" data-ref-parent="fig-statistics-binomial"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-statistics-binomial-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Cumulative distribution function.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-statistics-binomial-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;14.3: Binomial distribution - basic functions.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="exm-statistics-bernoulli_dist" class="theorem example">
<p><span class="theorem-title"><strong>Example 14.4 (Bernoulli distribution)</strong></span> The Bernoulli distribution is a discrete probability function which takes the value <span class="math inline">\(1\)</span> with probability <span class="math inline">\(p\)</span> and the value <span class="math inline">\(0\)</span> with probability <span class="math inline">\(q=1-p\)</span>. It is how we can model a coin toss or anything that is expressed in a <em>yes-no question</em>.</p>
<p>It is the special case of a Binomial distribution <a href="#exm-statistics-binomial_dist" class="quarto-xref">Example&nbsp;<span>14.3</span></a> with <span class="math inline">\(n=1\)</span>.</p>
<p>The probability density function becomes <span class="math display">\[
f(x) = p^x (1-p)^{1-x} \quad\text{for}\quad x\in \{0,1\}
\]</span> and the corresponding CDF <span class="math display">\[
F(x) = \begin{cases}
0 \quad &amp;\text{if}\, x \leq 0,\\
1-p \quad &amp;\text{if}\, 0\leq x \le 1,\\
1 \quad &amp;\text{if}\, x \geq 1.
\end{cases}
\]</span></p>
</div>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="exm-statistics-cont_dist" class="theorem example">
<p><span class="theorem-title"><strong>Example 14.5 (Continuous uniform distribution)</strong></span> The continuous uniform distribution is also called the rectangular distribution and describes an outcome that lies between certain bounds.</p>
<p>The probability density function is <span class="math display">\[
f(x) =
\begin{cases}
\frac{1}{b-a} \quad &amp;\text{if}\_ a \leq x \leq b,\\
0 \quad &amp;\text{else.}
\end{cases}
\]</span> and the corresponding CDF <span class="math display">\[
F(x) =
\begin{cases}
\frac{x-a}{b-a} \quad &amp;\text{if}\_ a \leq x \leq b,\\
0 \quad &amp;\text{else.}
\end{cases}
\]</span></p>
<details class="code-fold">
<summary>Show the code for the figure</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>config InlineBackend.figure_formats <span class="op">=</span> [<span class="st">"svg"</span>]</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> <span class="kw">lambda</span> x: np.astype((x <span class="op">&gt;=</span> a) <span class="op">&amp;</span> (x <span class="op">&lt;</span> b), <span class="bu">float</span>) <span class="op">/</span> (b <span class="op">-</span> a)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>cfd <span class="op">=</span> <span class="kw">lambda</span> x: (x <span class="op">-</span> a) <span class="op">/</span> (b <span class="op">-</span> a) <span class="op">*</span> np.astype((x <span class="op">&gt;=</span> a) <span class="op">&amp;</span> (x <span class="op">&lt;</span> b) , <span class="bu">float</span>) <span class="op">+</span> <span class="op">\</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>                np.astype((x <span class="op">&gt;=</span> b) , <span class="bu">float</span>)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1024</span>)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>plt.figure()</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>plt.plot(x, f(x))</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>plt.gca().set_aspect(<span class="dv">3</span><span class="op">/</span>(<span class="dv">3</span> <span class="op">*</span> <span class="dv">1</span>))</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>plt.figure()</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>plt.plot(x, cfd(x))</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>plt.gca().set_aspect(<span class="dv">3</span><span class="op">/</span>(<span class="dv">3</span> <span class="op">*</span> <span class="dv">1</span>))</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-statistics-cud" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-statistics-cud-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-statistics-cud" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="fig-statistics-cud-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-statistics-cud-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="bayesian_files/figure-html/fig-statistics-cud-output-1.svg" class="lightbox" data-gallery="fig-statistics-cud" title="Figure&nbsp;14.4&nbsp;(a): Probability density function."><img src="bayesian_files/figure-html/fig-statistics-cud-output-1.svg" class="img-fluid figure-img" data-ref-parent="fig-statistics-cud"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-statistics-cud-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Probability density function.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="cell-output cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-statistics-cud" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="fig-statistics-cud-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-statistics-cud-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="bayesian_files/figure-html/fig-statistics-cud-output-2.svg" class="lightbox" data-gallery="fig-statistics-cud" title="Figure&nbsp;14.4&nbsp;(b): Cumulative distribution function."><img src="bayesian_files/figure-html/fig-statistics-cud-output-2.svg" class="img-fluid figure-img" data-ref-parent="fig-statistics-cud"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-statistics-cud-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Cumulative distribution function.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-statistics-cud-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;14.4: Continuous uniform distribution - basic functions.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="exm-statistics-normal_dist" class="theorem example">
<p><span class="theorem-title"><strong>Example 14.6 (Normal distribution)</strong></span> The normal distribution or Gaussian distribution is a continuous probability function for a real valued random variable.</p>
<p>The probability density function is <span class="math display">\[
f(x) = \mathcal{N}[\mu, \sigma^2](x) = \frac{1}{\sqrt{2 \pi \sigma^2}}\mathrm{e}^{-\frac{(x - \mu)^2}{2\sigma^2}},
\]</span> where <span class="math inline">\(\mu\)</span> is called the mean and the parameter <span class="math inline">\(\delta^2\)</span> is the called the variance. The standard deviation of the distribution is <span class="math inline">\(\sigma\)</span>. For <span class="math inline">\(\mu = 0\)</span> and <span class="math inline">\(\sigma^2=1\)</span> it is called the <strong>standard normal distribution</strong>.</p>
<p>The corresponding CDF of the standard normal distribution is <span class="math display">\[
\Phi(x) = \frac{1}{\sqrt{2\pi}}\int_{-\infty}^x \mathrm{e}^{-\frac{t^2}{2}}\, \mathrm{d}t,
\]</span> and the generic form is <span class="math display">\[
F(x) = \Phi\left(\frac{x-\mu}{\sigma}\right).
\]</span> <span class="math inline">\(\Phi(x)\)</span> is expressed in terms of the error function <span class="math display">\[
\Phi(x) = \frac12\left(1 + \operatorname{erf}\left(\frac{x}{\sqrt{2}}\right)\right), \quad\text{with}\quad \operatorname{erf}(x) = \frac{1}{\sqrt{2}}\int_{0}^x\mathrm{e}^{-t^2}\, \mathrm{d}t.
\]</span></p>
<details class="code-fold">
<summary>Show the code for the figure</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>config InlineBackend.figure_formats <span class="op">=</span> [<span class="st">"svg"</span>]</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> <span class="kw">lambda</span> mu, sigma, x: <span class="dv">1</span> <span class="op">/</span> np.sqrt(<span class="dv">2</span> <span class="op">*</span> np.pi <span class="op">*</span> sigma<span class="op">**</span><span class="dv">2</span>) <span class="op">*</span> <span class="op">\</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    np.exp(<span class="op">-</span> (x <span class="op">-</span> mu)<span class="op">**</span><span class="dv">2</span> <span class="op">/</span> (<span class="dv">2</span> <span class="op">*</span> sigma<span class="op">**</span><span class="dv">2</span>))</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>phi <span class="op">=</span> np.vectorize(<span class="kw">lambda</span> x: <span class="dv">1</span><span class="op">/</span><span class="dv">2</span> <span class="op">*</span> (<span class="dv">1</span> <span class="op">+</span> math.erf(x <span class="op">/</span> np.sqrt(<span class="dv">2</span>))))</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>cfd <span class="op">=</span> <span class="kw">lambda</span> mu, sigma, x: phi((x <span class="op">-</span> mu) <span class="op">/</span> sigma)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">1024</span>)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>plt.figure()</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>plt.plot(x, f(<span class="dv">0</span>, <span class="dv">1</span>, x),</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>         label<span class="op">=</span><span class="vs">r"$\mu=0$, $\sigma^2=1$"</span>)</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>plt.plot(x, f(<span class="dv">0</span>, np.sqrt(<span class="fl">0.1</span>), x),</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>         label<span class="op">=</span><span class="vs">r"$\mu=0$, $\sigma^2=0.1$"</span>)</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>plt.plot(x, f(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>, np.sqrt(<span class="fl">0.5</span>), x),</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>         label<span class="op">=</span><span class="vs">r"$\mu=\frac</span><span class="sc">{1}{2}</span><span class="vs">$, $\sigma^2=0.5$"</span>)</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>plt.gca().set_aspect(<span class="dv">6</span><span class="op">/</span>(<span class="dv">3</span> <span class="op">*</span> <span class="fl">1.25</span>))</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>plt.figure()</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>plt.plot(x, cfd(<span class="dv">0</span>, <span class="dv">1</span>, x),</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>         label<span class="op">=</span><span class="vs">r"$\mu=0$, $\sigma^2=1$"</span>)</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>plt.plot(x, cfd(<span class="dv">0</span>, np.sqrt(<span class="fl">0.1</span>), x),</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>         label<span class="op">=</span><span class="vs">r"$\mu=0$, $\sigma^2=0.1$"</span>)</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>plt.plot(x, cfd(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>, np.sqrt(<span class="fl">0.5</span>), x),</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>         label<span class="op">=</span><span class="vs">r"$\mu=\frac</span><span class="sc">{1}{2}</span><span class="vs">$, $\sigma^2=0.5$"</span>)</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>plt.gca().set_aspect(<span class="dv">6</span><span class="op">/</span>(<span class="dv">3</span> <span class="op">*</span> <span class="dv">1</span>))</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-statistics-nd" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-statistics-nd-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-statistics-nd" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="fig-statistics-nd-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-statistics-nd-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="bayesian_files/figure-html/fig-statistics-nd-output-1.svg" class="lightbox" data-gallery="fig-statistics-nd" title="Figure&nbsp;14.5&nbsp;(a): Probability density function."><img src="bayesian_files/figure-html/fig-statistics-nd-output-1.svg" class="img-fluid figure-img" data-ref-parent="fig-statistics-nd"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-statistics-nd-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Probability density function.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="cell-output cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-statistics-nd" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="fig-statistics-nd-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-statistics-nd-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="bayesian_files/figure-html/fig-statistics-nd-output-2.svg" class="lightbox" data-gallery="fig-statistics-nd" title="Figure&nbsp;14.5&nbsp;(b): Cumulative distribution function."><img src="bayesian_files/figure-html/fig-statistics-nd-output-2.svg" class="img-fluid figure-img" data-ref-parent="fig-statistics-nd"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-statistics-nd-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Cumulative distribution function.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-statistics-nd-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;14.5: Normal distribution - basic functions.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="exm-statistics-normal_gammainv" class="theorem example">
<p><span class="theorem-title"><strong>Example 14.7 (Inverse <span class="math inline">\(\Gamma\)</span> distribution)</strong></span> The main use of the inverse <span class="math inline">\(\Gamma\)</span> distribution is in Bayesian statistics.</p>
<p>The probability density function is given by <span class="math display">\[
f(x) = \frac{\beta^\alpha}{\Gamma(\alpha)}\frac{1}{x^{\alpha+1}}\mathrm{e}^{-\frac{\beta}{x}},
\]</span> for the shape parameter <span class="math inline">\(\alpha\)</span>, the scale parameter <span class="math inline">\(\beta\)</span> and the name giving <span class="math inline">\(\Gamma\)</span> function.</p>
<p>The corresponding CDF is <span class="math display">\[
F(x) = \frac{\Gamma\left(\alpha, \frac{\beta}{x}\right)}{\Gamma(\alpha)}
\]</span> where the numerator is called the upper incomplete gamma function.</p>
<details class="code-fold">
<summary>Show the code for the figure</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scipy</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>config InlineBackend.figure_formats <span class="op">=</span> [<span class="st">"svg"</span>]</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> <span class="kw">lambda</span> alpha, beta, x: np.<span class="bu">pow</span>(beta, alpha) <span class="op">/</span> math.gamma(alpha) <span class="op">*</span> <span class="op">\</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>                           np.<span class="bu">pow</span>(<span class="dv">1</span><span class="op">/</span>x, <span class="dv">1</span> <span class="op">+</span> alpha) <span class="op">*</span> np.exp(<span class="op">-</span>beta<span class="op">/</span>x)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>cfd <span class="op">=</span> <span class="kw">lambda</span> alpha, beta, x: scipy.special.gdtr(alpha, beta, x)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="fl">1e-3</span>, <span class="dv">3</span>, <span class="dv">1024</span>)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>plt.figure()</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>plt.plot(x, f(<span class="dv">1</span>, <span class="dv">1</span>, x), label<span class="op">=</span><span class="vs">r"$\alpha=1$, $\beta=1$"</span>)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>plt.plot(x, f(<span class="dv">3</span>, <span class="dv">1</span>, x), label<span class="op">=</span><span class="vs">r"$\alpha=3$, $\beta=1$"</span>)</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>plt.plot(x, f(<span class="dv">3</span>, <span class="fl">0.5</span>, x), label<span class="op">=</span><span class="vs">r"$\alpha=3$, $\beta=0.5$"</span>)</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>plt.gca().set_aspect(<span class="dv">4</span><span class="op">/</span>(<span class="dv">3</span> <span class="op">*</span> <span class="dv">5</span>))</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>plt.figure()</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>plt.plot(x, cfd(<span class="dv">1</span>, <span class="dv">1</span>, x), label<span class="op">=</span><span class="vs">r"$\mu=0$, $\sigma^2=1$"</span>)</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>plt.plot(x, cfd(<span class="dv">3</span>, <span class="dv">1</span>, x), label<span class="op">=</span><span class="vs">r"$\mu=0$, $\sigma^2=0.1$"</span>)</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>plt.plot(x, cfd(<span class="dv">3</span>, <span class="fl">0.5</span>, x), label<span class="op">=</span><span class="vs">r"$\mu=\frac</span><span class="sc">{1}{2}</span><span class="vs">$, $\sigma^2=0.5$"</span>)</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>plt.gca().set_aspect(<span class="dv">6</span><span class="op">/</span>(<span class="dv">3</span> <span class="op">*</span> <span class="dv">1</span>))</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-statistics-gammainv" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-statistics-gammainv-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-statistics-gammainv" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="fig-statistics-gammainv-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-statistics-gammainv-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="bayesian_files/figure-html/fig-statistics-gammainv-output-1.svg" class="lightbox" data-gallery="fig-statistics-gammainv" title="Figure&nbsp;14.6&nbsp;(a): Probability density function."><img src="bayesian_files/figure-html/fig-statistics-gammainv-output-1.svg" class="img-fluid figure-img" data-ref-parent="fig-statistics-gammainv"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-statistics-gammainv-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Probability density function.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="cell-output cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-statistics-gammainv" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="fig-statistics-gammainv-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-statistics-gammainv-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="bayesian_files/figure-html/fig-statistics-gammainv-output-2.svg" class="lightbox" data-gallery="fig-statistics-gammainv" title="Figure&nbsp;14.6&nbsp;(b): Cumulative distribution function."><img src="bayesian_files/figure-html/fig-statistics-gammainv-output-2.svg" class="img-fluid figure-img" data-ref-parent="fig-statistics-gammainv"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-statistics-gammainv-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Cumulative distribution function.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-statistics-gammainv-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;14.6: Inverse Gamma distribution - basic functions.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="bayes-theorem-in-action" class="level2" data-number="14.3">
<h2 data-number="14.3" class="anchored" data-anchor-id="bayes-theorem-in-action"><span class="header-section-number">14.3</span> Bayes’ theorem in action</h2>
<p>What Bayes was after was the basic question of data science: find the parameters of a model given the outcome data together with the model. The theorem can be used as an update for the probability we have with additional information and therefore fitting our parameters.</p>
<p>Before we get to an example let us consider the terms of the theorem once more.</p>
<ol type="1">
<li><p>The prior expresses our initial believe of the outcome. If we know nothing about it we can use an non-informative prior like the uniform distribution.</p></li>
<li><p>The likelihood is similar to a probability distribution but the integral is not 1. As the name suggest it is the likelihood of a certain experiment result as a function of the parameters of the <em>model</em>. If we select the likelihood as a conjugate to the prior we know the shape of the posterior and this can speed up the calculation.</p></li>
<li><p>The denominator are there to normalize the posterior so that the posterior becomes a probability distribution with integral 1.</p></li>
<li><p>The posterior are our main result of the so called Bayers inference. If we have multiple samples we can use it as the prior for the next.</p></li>
</ol>
<p>Let us look at some more elaborate examples to show how Bayes theorem can be used.</p>
<section id="election-prediction-as-instructive-example" class="level3" data-number="14.3.1">
<h3 data-number="14.3.1" class="anchored" data-anchor-id="election-prediction-as-instructive-example"><span class="header-section-number">14.3.1</span> Election prediction as instructive example</h3>
<p>Here we give a rudimentary introduction to election forecasts (this example follows the notes <span class="citation" data-cites="mehrle">Mehrle (<a href="../references.html#ref-mehrle" role="doc-biblioref">2024</a>)</span>).</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>So far our probabilities where not continuous functions. For this example we need continuous functions and to reflect this in the notation we use small letters.</p>
</div>
</div>
<p>First we need to get a relative vote for party <span class="math inline">\(x\)</span> which might come from the last elections or a prior poll. We assume <span class="math inline">\(\mu = 20\%\)</span> and express the uncertainty in our estimate with a normal distribution with standard deviation of <span class="math inline">\(\sigma = 5\%\)</span>.</p>
<p>The resulting probability distribution becomes <span class="math display">\[
p(x) = \mathcal{N}[\mu, \sigma^2](x) = \frac{1}{\sqrt{2 \pi \sigma^2}}\mathrm{e}^{-\frac{(x - \mu)^2}{2\sigma^2}}
\]</span> and in our case we get <span class="math inline">\(p(x) = \mathcal{N}[0.2, 0.05^2](x)\)</span>.</p>
<div id="cell-fig-statistics-bayesian-vote1" class="cell" data-execution_count="6">
<details class="code-fold">
<summary>Show the code for the figure</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>config InlineBackend.figure_formats <span class="op">=</span> [<span class="st">"svg"</span>]</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>normaldist <span class="op">=</span> <span class="kw">lambda</span> mu, sigma, x: <span class="dv">1</span> <span class="op">/</span> np.sqrt(<span class="dv">2</span> <span class="op">*</span> np.pi <span class="op">*</span> sigma<span class="op">**</span><span class="dv">2</span>) <span class="op">*</span> <span class="op">\</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    np.exp(<span class="op">-</span> (x <span class="op">-</span> mu)<span class="op">**</span><span class="dv">2</span> <span class="op">/</span> (<span class="dv">2</span> <span class="op">*</span> sigma<span class="op">**</span><span class="dv">2</span>))</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> <span class="kw">lambda</span> x: normaldist(<span class="fl">0.2</span>, <span class="fl">0.05</span>, x)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1024</span>)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>plt.figure()</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>plt.plot(x, p(x))</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="st">"major"</span>)</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>plt.gca().set_aspect(<span class="dv">1</span><span class="op">/</span>(<span class="dv">3</span> <span class="op">*</span> <span class="dv">8</span>))</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="vs">r"$x$"</span>)</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="vs">r"$p(x)$"</span>)</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-statistics-bayesian-vote1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-statistics-bayesian-vote1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="bayesian_files/figure-html/fig-statistics-bayesian-vote1-output-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-11" title="Figure&nbsp;14.7: Probability density for our initial guess of the vote for party x."><img src="bayesian_files/figure-html/fig-statistics-bayesian-vote1-output-1.svg" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-statistics-bayesian-vote1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;14.7: Probability density for our initial guess of the vote for party x.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Now we improvement our estimate with the help of Bayes’ theorem by asking <em>random</em> people what they will vote.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Of course this needs to be done in the proper way to make sure it is not biased. We assume to not be biased.</p>
</div>
</div>
<p>The probability that exactly <span class="math inline">\(k\)</span> people of a random sample of size <span class="math inline">\(n\)</span> vote for party <span class="math inline">\(x\)</span> is a best described with a binomial distribution <span class="math display">\[
p\left(\frac{k}{n} | x\right) = \left(\begin{array}{c} n\\ k\end{array}\right) x^k (1-x)^{n-k}.
\]</span></p>
<div id="cell-fig-statistics-bayesian-vote2" class="cell" data-execution_count="7">
<details class="code-fold">
<summary>Show the code for the figure</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scipy</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>bino <span class="op">=</span> <span class="kw">lambda</span> k, n, x: scipy.special.comb(n, k) <span class="op">*</span> np.<span class="bu">pow</span>(x, k) <span class="op">*</span> <span class="op">\</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>                       np.<span class="bu">pow</span>(<span class="dv">1</span><span class="op">-</span>x, n <span class="op">-</span> k)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>p2 <span class="op">=</span> <span class="kw">lambda</span> x: bino(<span class="dv">2</span>, <span class="dv">10</span>, x)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1024</span>)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>plt.figure()</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>plt.plot(x, p2(x))</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="st">"major"</span>)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>plt.gca().set_aspect(<span class="dv">1</span>)</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="vs">r"$x$"</span>)</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="vs">r"$p(\frac</span><span class="sc">{5}{15}</span><span class="vs">|x)$"</span>)</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-statistics-bayesian-vote2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-statistics-bayesian-vote2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="bayesian_files/figure-html/fig-statistics-bayesian-vote2-output-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-12" title="Figure&nbsp;14.8: Probability density of k=5 positives out of n=15 samples."><img src="bayesian_files/figure-html/fig-statistics-bayesian-vote2-output-1.svg" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-statistics-bayesian-vote2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;14.8: Probability density of k=5 positives out of n=15 samples.
</figcaption>
</figure>
</div>
</div>
</div>
<p>In order to compute <span class="math inline">\(p(\frac{k}{n})\)</span> we need to integrate our two results <span class="math display">\[
p\left(\frac{k}{n}\right) = \int_0^1 p\left(\frac{k}{n} | x\right) p(x)\,\mathrm{d}x
\]</span></p>
<p>So for a given sample size <span class="math inline">\(n\)</span> and positive samples <span class="math inline">\(k\)</span> we get a new distribution.</p>
<div id="cell-fig-statistics-bayesian-vote3" class="cell" data-execution_count="8">
<details class="code-fold">
<summary>Show the code for the figure</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>p3 <span class="op">=</span> <span class="kw">lambda</span> k, n: scipy.integrate.quad(<span class="kw">lambda</span> x: bino(k, n, x) <span class="op">*</span> p(x), <span class="dv">0</span>, <span class="dv">1</span>)[<span class="dv">0</span>]</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>p4 <span class="op">=</span> <span class="kw">lambda</span> k, n ,x: p(x) <span class="op">*</span> bino(k, n, x) <span class="op">/</span> p3(k, n)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1024</span>)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>plt.figure()</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>plt.plot(x, p4(<span class="dv">5</span>, <span class="dv">15</span>, x), label<span class="op">=</span><span class="vs">r"$n=5, k=15$"</span>)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>plt.plot(x, p4(<span class="dv">50</span>, <span class="dv">150</span>, x), <span class="st">":"</span>, label<span class="op">=</span><span class="vs">r"$n=50, k=150$"</span>)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>plt.plot(x, p4(<span class="dv">0</span>, <span class="dv">15</span>, x), <span class="st">"-."</span>, label<span class="op">=</span><span class="vs">r"$n=0, k=15$"</span>)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="st">"major"</span>)</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>plt.gca().set_aspect(<span class="dv">1</span> <span class="op">/</span> (<span class="dv">3</span> <span class="op">*</span> <span class="dv">14</span>))</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="vs">r"$x$"</span>)</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="vs">r"$p(x|\frac</span><span class="sc">{k}{n}</span><span class="vs">)$"</span>)</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-statistics-bayesian-vote3" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-statistics-bayesian-vote3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="bayesian_files/figure-html/fig-statistics-bayesian-vote3-output-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-13" title="Figure&nbsp;14.9: Parameter likelihood after a survey with k=5 positives out of n=15 samples (solid - blue) and k=15 out of n=150 samples (dotted)."><img src="bayesian_files/figure-html/fig-statistics-bayesian-vote3-output-1.svg" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-statistics-bayesian-vote3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;14.9: Parameter likelihood after a survey with k=5 positives out of n=15 samples (solid - blue) and k=15 out of n=150 samples (dotted).
</figcaption>
</figure>
</div>
</div>
</div>
<p>In <a href="#fig-statistics-bayesian-vote3" class="quarto-xref">Figure&nbsp;<span>14.9</span></a> we can see that the peak moves from <span class="math inline">\(0.2\)</span> closer to <span class="math inline">\(\tfrac13\)</span> (our pooling results) and the bigger our sample size gets the more likely our change is (we get closer).</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>A point that is often criticised regarding the <em>Bayesian inference</em> we applied here is that it is highly dependent on the initial guess (<a href="#fig-statistics-bayesian-vote1" class="quarto-xref">Figure&nbsp;<span>14.7</span></a>).</p>
</div>
</div>
</section>
<section id="material-properties" class="level3" data-number="14.3.2">
<h3 data-number="14.3.2" class="anchored" data-anchor-id="material-properties"><span class="header-section-number">14.3.2</span> Material properties</h3>
<p>To identify material properties such as strength we can also use Bayes’ theorem.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>This example follows the notes <span class="citation" data-cites="mehrle">Mehrle (<a href="../references.html#ref-mehrle" role="doc-biblioref">2024</a>)</span> but as we do not have the data the plots are not generated interactively.</p>
</div>
</div>
<p>Again we start with an initial guess, in this case for the yield stress with <span class="math inline">\(90\%\)</span> of the samples endure in our experiment.</p>
<p>For steel <em>S235JR</em> this is <span class="math inline">\(R_{aH,0} = 235 \mathrm{MPa}\)</span>. We use a Gaussian normal distribution with <span class="math inline">\(\mu_0 = 270\mathrm{MPa}\)</span> and <span class="math inline">\(\sigma_0 = 27.3 \mathrm{MPa}\)</span>.</p>
<div id="cell-fig-statistics-bayesian-material1" class="cell" data-execution_count="9">
<details class="code-fold">
<summary>Show the code for the figure</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>config InlineBackend.figure_formats <span class="op">=</span> [<span class="st">"svg"</span>]</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>normaldist <span class="op">=</span> <span class="kw">lambda</span> mu, sigma, x: <span class="dv">1</span> <span class="op">/</span> np.sqrt(<span class="dv">2</span> <span class="op">*</span> np.pi <span class="op">*</span> sigma<span class="op">**</span><span class="dv">2</span>) <span class="op">*</span> <span class="op">\</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    np.exp(<span class="op">-</span> (x <span class="op">-</span> mu)<span class="op">**</span><span class="dv">2</span> <span class="op">/</span> (<span class="dv">2</span> <span class="op">*</span> sigma<span class="op">**</span><span class="dv">2</span>))</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>Finv <span class="op">=</span> <span class="kw">lambda</span> mu, sigma, p: mu <span class="op">+</span> sigma <span class="op">*</span> np.sqrt(<span class="dv">2</span>) <span class="op">*</span> <span class="op">\</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>                            scipy.special.erfinv(<span class="dv">2</span> <span class="op">*</span> p <span class="op">-</span> <span class="dv">1</span>) </span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>mu_0 <span class="op">=</span> <span class="dv">270</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>sigma_0 <span class="op">=</span> <span class="fl">27.31</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>RaH_0 <span class="op">=</span> Finv(mu_0, sigma_0, <span class="fl">0.1</span>)</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> <span class="kw">lambda</span> x: normaldist(mu_0, sigma_0, x)</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">400</span>, <span class="dv">1024</span>)</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>plt.figure()</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>plt.plot(x, p(x))</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>plt.fill_between(x, p(x), where<span class="op">=</span>(x <span class="op">&gt;</span> RaH_0))</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>my_max <span class="op">=</span> np.<span class="bu">round</span>(np.<span class="bu">max</span>(p(x)), <span class="dv">3</span>)</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>plt.plot([RaH_0, RaH_0], [<span class="dv">0</span>, my_max])</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="st">"major"</span>)</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>plt.gca().set_aspect(<span class="dv">400</span><span class="op">/</span>(<span class="dv">3</span> <span class="op">*</span> my_max))</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="vs">r"$x$"</span>)</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="vs">r"$p(R_</span><span class="sc">{aH}</span><span class="vs">)$"</span>)</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-statistics-bayesian-material1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-statistics-bayesian-material1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="bayesian_files/figure-html/fig-statistics-bayesian-material1-output-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-14" title="Figure&nbsp;14.10: Initial assumption for the yield stress of the material, the coloured part represents the 90% of samples that have a yield stress larger than 235."><img src="bayesian_files/figure-html/fig-statistics-bayesian-material1-output-1.svg" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-statistics-bayesian-material1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;14.10: Initial assumption for the yield stress of the material, the coloured part represents the 90% of samples that have a yield stress larger than 235.
</figcaption>
</figure>
</div>
</div>
</div>
<p>This time our parameters <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span> are uncertain and need to be modified, furthermore, they do not follow a binomial distribution but our assumption is that they are better described by a normal distribution <span class="math display">\[
p(\mu) = \mathcal{N}(\mu_0, \sigma_{\mu_0}),\quad\text{with}\quad \sigma_{\mu_0} = \frac{\mu_0}{10},
\]</span> and <span class="math display">\[
p(\sigma) = \mathcal{N}(\sigma_0, \sigma_{\sigma_0}),\quad\text{with}\quad \sigma_{\sigma_0} = \frac{\sigma_0}{10}.
\]</span></p>
<p>The likelihood of drawing a sample with yield strength <span class="math inline">\(R_{aH}^{(i)}\)</span> we calculate the dependent probabilities separate by fixing the <em>current</em> values of <span class="math inline">\(\mu = \check{\mu}\)</span> and <span class="math inline">\(\sigma = \check{\sigma}\)</span>, respectively. <span class="math display">\[
p\left(R_{aH}^{(i)} | \mu \right) = \mathcal{N}[\mu, \check{\sigma}](R_{aH}^{(i)})
\]</span> and <span class="math display">\[
p\left(R_{aH}^{(i)} | \sigma \right) = \mathcal{N}[\check{\mu}, \sigma](R_{aH}^{(i)})
\]</span> and with Bayes’ theorem we can compute <span class="math display">\[
p\left( \mu | R_{aH}^{(i)}\right)  = \frac{p\left(R_{aH}^{(i)} | \mu \right) p(\mu)}{\int p\left(R_{aH}^{(i)} | \mu \right) p(\mu)\,\mathrm{d}\mu},
\]</span> and <span class="math display">\[
p\left( \sigma | R_{aH}^{(i)}\right)  = \frac{p\left(R_{aH}^{(i)} | \sigma \right) p(\sigma)}{\int p\left(R_{aH}^{(i)} | \sigma \right) p(\sigma)\,\mathrm{d}\sigma},
\]</span></p>
<p>Now by computing the inverse from our above probabilities we can update our <span class="math inline">\(\mu_0\)</span> and <span class="math inline">\(\sigma_0\)</span> accordingly. This we can continue for several samples.</p>
<div id="cell-fig-statistics-bayesian-material2" class="cell" data-execution_count="10">
<div class="cell-output cell-output-display">
<div id="fig-statistics-bayesian-material2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-statistics-bayesian-material2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="bayesian_files/figure-html/fig-statistics-bayesian-material2-output-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-15" title="Figure&nbsp;14.11: Update after 10 and 100 iterations"><img src="bayesian_files/figure-html/fig-statistics-bayesian-material2-output-1.svg" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-statistics-bayesian-material2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;14.11: Update after 10 and 100 iterations
</figcaption>
</figure>
</div>
</div>
</div>
<p>The mean converges relatively fast and stays but the deviation still changes after 100 sample drawn. This is due to the fact that the two variables are not independent of each other and the assumption that of a normal distribution is not a good estimate for <span class="math inline">\(\sigma\)</span>.</p>
</section>
</section>
<section id="conjugate-priors" class="level2" data-number="14.4">
<h2 data-number="14.4" class="anchored" data-anchor-id="conjugate-priors"><span class="header-section-number">14.4</span> Conjugate priors</h2>
<p>The above updates are relatively expensive in terms of computing and are not handy. The idea is to find the updates analytically.</p>
<p>In general this is not <em>likely to happen</em> but for certain combinations of density functions the convert neatly into each other under Bayers’ theorem.</p>
<p>For the normal distribution this is the case and the update becomes <span class="math display">\[
\frac{1}{\sigma_{k+1}^2} = \frac{1}{\sigma_{k}^2} + \frac{1}{\sigma^2},
\]</span> and <span class="math display">\[
\mu_{k+1} = \left(\frac{\mu_k}{\sigma_{k}^2} + \frac{\mu}{\sigma^2}\right)\sigma^2_{k+1},
\]</span></p>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-Lambert2018-ll" class="csl-entry" role="listitem">
Lambert, Ben. 2018. <em>A Student’s Guide to Bayesian Statistics</em>. London, England: SAGE Publications.
</div>
<div id="ref-mehrle" class="csl-entry" role="listitem">
Mehrle, Andreas. 2024. <span>“<span>Data Science</span>.”</span> <em>Management Center Innsbruck, Reader for the Course</em>.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/kandolfp\.github\.io\/MECH-M-DUAL-1-DBM\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../statistics/index.html" class="pagination-link" aria-label="Statistics">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Statistics</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../statistics/kalman.html" class="pagination-link" aria-label="Kalman Filter">
        <span class="nav-page-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Kalman Filter</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Basics of Data Science WS 2024 (MECH-M-DUAL-1-GDM)</p>
</div>   
    <div class="nav-footer-center">
<p><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> Peter Kandolf</p>
<div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/kandolfp/MECH-M-DUAL-1-DBM/edit/main/statistics/bayesian.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/kandolfp/MECH-M-DUAL-1-DBM/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>This book was built with <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>